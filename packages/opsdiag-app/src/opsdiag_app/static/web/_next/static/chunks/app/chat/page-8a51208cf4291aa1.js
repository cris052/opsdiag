(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8457],{16710:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var l=a(95155),r=a(28867),o=a(12115),n=a(54099),i=a(62471),s=a(50715),d=a(93640),u=a(31217),m=a(47937),c=a(86253),v=a(16467),p=a(17238),f=a(35695),x=a(91070),h=a(86355);function _(){let[e,t]=(0,o.useState)([]);(0,f.useRouter)(),(0,o.useEffect)(()=>{a()},[]);let{run:a,loading:i}=(0,n.A)(async()=>{let[e,t]=await (0,r.Vb)((0,r.eH)({page:1,page_size:10,published:!0}));return t},{manual:!0,onSuccess:e=>{e&&t(e.app_list||[])}});return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-violet-50 via-cyan-50 to-emerald-50 dark:from-slate-900 dark:via-violet-900 dark:to-emerald-900 relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,l.jsx)("div",{className:"absolute -top-32 -right-32 w-96 h-96 bg-gradient-to-br from-violet-400/40 to-cyan-500/30 rounded-full blur-3xl animate-pulse"}),(0,l.jsx)("div",{className:"absolute -bottom-40 -left-40 w-[32rem] h-[32rem] bg-gradient-to-tr from-emerald-400/35 to-teal-500/25 rounded-full blur-3xl animate-bounce"}),(0,l.jsx)("div",{className:"absolute top-1/4 right-1/3 w-80 h-80 bg-gradient-to-r from-cyan-300/30 to-violet-400/25 rounded-full blur-2xl animate-pulse delay-1000"}),(0,l.jsx)("div",{className:"absolute bottom-1/3 left-1/4 w-64 h-64 bg-gradient-to-br from-teal-300/35 to-emerald-400/30 rounded-full blur-xl animate-bounce delay-500"}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-to-r from-violet-300/20 to-cyan-300/20 rounded-full blur-2xl animate-spin-slow"})]}),(0,l.jsx)("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-fit py-12 px-6",children:(0,l.jsxs)("div",{className:"w-full max-w-5xl mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-16",children:[(0,l.jsxs)("div",{className:"inline-flex items-center justify-center p-6 mb-6 bg-white/95 dark:bg-slate-800/95 backdrop-blur-xl rounded-2xl shadow-lg border border-white/40 dark:border-slate-600/40 hover:shadow-xl hover:scale-105 transition-all duration-500 group",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-violet-500 via-cyan-500 to-emerald-500 rounded-2xl mr-4 shadow-lg group-hover:rotate-12 transition-transform duration-500",children:(0,l.jsx)("span",{className:"text-xl",children:"\uD83E\uDD16"})}),(0,l.jsx)("div",{className:"text-left",children:(0,l.jsx)("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-violet-600 via-cyan-600 to-emerald-600 group-hover:scale-105 transition-transform duration-500",children:"OpsDiag私有云智能助手"})})]}),(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsx)("p",{className:"text-base md:text-lg text-slate-600 dark:text-slate-300 font-medium text-center",children:"智能运维 \xb7 私有部署 \xb7 7\xd724小时服务"})})]}),(0,l.jsx)("div",{className:"mb-16",children:(0,l.jsxs)("div",{className:"bg-white/95 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/50 dark:border-slate-600/50 p-12 hover:shadow-3xl transition-all duration-500 hover:scale-[1.02] transform group",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 flex items-center",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-violet-500 to-cyan-500 rounded-2xl mr-4 shadow-lg group-hover:rotate-6 transition-transform duration-300",children:(0,l.jsx)("span",{className:"text-lg",children:"\uD83D\uDCAC"})}),"开始新的对话"]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,l.jsx)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"实时响应"})]})]}),(0,l.jsx)("p",{className:"text-base text-slate-600 dark:text-slate-300 mb-4",children:"\uD83D\uDE80 输入您的运维问题，我将为您提供专业的解决方案"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 mb-8",children:[(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-violet-100 to-violet-200 dark:from-violet-900/50 dark:to-violet-800/50 text-violet-700 dark:text-violet-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDD0D 系统监控"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-cyan-100 to-cyan-200 dark:from-cyan-900/50 dark:to-cyan-800/50 text-cyan-700 dark:text-cyan-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDD27 故障诊断"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/50 dark:to-emerald-800/50 text-emerald-700 dark:text-emerald-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"⚡ 性能优化"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-teal-100 to-teal-200 dark:from-teal-900/50 dark:to-teal-800/50 text-teal-700 dark:text-teal-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDEE1️ 安全防护"})]})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-r from-violet-400 via-cyan-400 to-emerald-400 rounded-3xl blur opacity-25 group-hover:opacity-40 transition duration-1000"}),(0,l.jsx)(h.A,{bodyClassName:"relative min-h-[140px] bg-gradient-to-br from-violet-50/80 via-white to-cyan-50/80 dark:from-slate-700 dark:via-slate-600 dark:to-slate-600 border-2 border-violet-200 dark:border-violet-700 rounded-3xl shadow-inner focus-within:border-violet-400 dark:focus-within:border-violet-500 focus-within:shadow-xl transition-all duration-500 placeholder:text-slate-400",minRows:5,maxRows:10,cneterBtn:!1})]})]})})]})})]})}let{Content:g}=c.A;function b(){var e,t,a,h,b;let y=(0,f.useSearchParams)(),w=null!=(t=(null==y?void 0:y.get("conv_uid"))||(null==y?void 0:y.get("chatId")))?t:"",j=null!=(a=null==y?void 0:y.get("app_code"))?a:"",N=null!=(h=null==y?void 0:y.get("model"))?h:"",k=null!=(b=null==y?void 0:y.get("knowledge"))?b:"",S=(0,o.useRef)(null),D=(0,o.useRef)(1),[A,C]=(0,o.useState)([]),[E]=(0,o.useState)(),[O,J]=(0,o.useState)(!1),[R,V]=(0,o.useState)(!1),[z,F]=(0,o.useState)(""),[P,B]=(0,o.useState)({}),[I,K]=(0,o.useState)(4e3),[M,U]=(0,o.useState)(),[Y,H]=(0,o.useState)(""),[T,X]=(0,o.useState)(!0),[q,G]=(0,o.useState)([]),[L,Q]=(0,o.useState)(""),[W,Z]=(0,o.useState)("");(0,o.useRef)(null);let{chat:$,ctrl:ee}=(0,d.A)({app_code:j||""});(0,o.useEffect)(()=>{var e,t,a;if(null==P||null==(t=P.layout)||null==(e=t.chat_in_layout)?void 0:e.length){let e=null==P||null==(a=P.layout)?void 0:a.chat_in_layout,t=e.find(e=>"temperature"===e.param_type),l=e.find(e=>"max_new_tokens"===e.param_type),r=e.find(e=>"resource"===e.param_type),o=e.find(e=>"model"===e.param_type),n=e.find(e=>"fault_type"===e.param_type),i=e.find(e=>"project_name"===e.param_type);(null==l?void 0:l.param_render_type)==="string"?K((null==l?void 0:l.param_default_value)||""):K(Number(null==l?void 0:l.param_default_value)||4e3),H(N||(null==o?void 0:o.param_default_value)||""),U(k||(null==r?void 0:r.param_default_value)||null),Q((null==n?void 0:n.param_default_value)||""),Z((null==i?void 0:i.param_default_value)||""),G([...t?[{param_type:"temperature",param_value:"string"==typeof(null==t?void 0:t.param_default_value)?null==t?void 0:t.param_default_value:JSON.stringify(null==t?void 0:t.param_default_value),sub_type:null==t?void 0:t.sub_type}]:[],...l?[{param_type:"max_new_tokens",param_value:"string"==typeof(null==l?void 0:l.param_default_value)?null==l?void 0:l.param_default_value:JSON.stringify(null==l?void 0:l.param_default_value),sub_type:null==l?void 0:l.sub_type}]:[],...r?[{param_type:"resource",param_value:"string"==typeof(null==r?void 0:r.param_default_value)?k||(null==r?void 0:r.param_default_value):JSON.stringify(k||(null==r?void 0:r.param_default_value)),sub_type:null==r?void 0:r.sub_type}]:[],...o?[{param_type:"model",param_value:"string"==typeof(null==o?void 0:o.param_default_value)?N||(null==o?void 0:o.param_default_value):JSON.stringify(N||(null==o?void 0:o.param_default_value)),sub_type:null==o?void 0:o.sub_type}]:[],...n?[{param_type:"fault_type",param_value:"string"==typeof(null==n?void 0:n.param_default_value)?null==n?void 0:n.param_default_value:JSON.stringify(null==n?void 0:n.param_default_value),sub_type:(null==n?void 0:n.sub_type)||""}]:[],...i?[{param_type:"project_name",param_value:"string"==typeof(null==i?void 0:i.param_default_value)?null==i?void 0:i.param_default_value:JSON.stringify(null==i?void 0:i.param_default_value),sub_type:(null==i?void 0:i.sub_type)||""}]:[]])}},[null==P||null==(e=P.layout)?void 0:e.chat_in_layout,N]);let et=(0,o.useMemo)(()=>!w,[w]),{data:ea=[],refresh:el,loading:er}=(0,n.A)(async()=>await (0,r.Vb)((0,r.b7)())),{run:eo,refresh:en,loading:ei}=(0,n.A)(async()=>await (0,r.Vb)((0,r.Y6)({app_code:j,building_mode:!1})),{manual:!0,onSuccess:e=>{let[,t]=e;B(t||{})}}),es=(0,o.useMemo)(()=>{let[,e]=ea;return(null==e?void 0:e.find(e=>e.conv_uid===w))||{}},[w,ea]);(0,o.useEffect)(()=>{j||!et?eo():et&&!j&&(0,r.Vb)((0,r.Y6)({app_code:"ai-coder",building_mode:!1})).then(e=>{let[,t]=e;B(t||{})})},[w,et,eo,j]);let{run:ed,loading:eu,refresh:em}=(0,n.A)(async()=>await (0,r.Vb)((0,r.r)(w)),{manual:!0,onSuccess:e=>{let[,t]=e,a=null==t?void 0:t.filter(e=>"view"===e.role);a&&a.length>0&&(D.current=a[a.length-1].order+1),C(t||[])}}),ec=(0,o.useCallback)((e,t)=>new Promise(a=>{var l,r,o,n,i,s;let d=(0,m.oF)(),u=new AbortController;if(J(!0),A&&A.length>0){let e=null==A?void 0:A.filter(e=>"view"===e.role),t=null==A?void 0:A.filter(e=>"human"===e.role);D.current=((null==(i=e[e.length-1])?void 0:i.order)||(null==(s=t[t.length-1])?void 0:s.order))+1}let c="";if("string"==typeof e)c=e;else{let t=e.content||[],a=t.filter(e=>"text"===e.type),l=t.filter(e=>"text"!==e.type);a.length>0&&(c=a.map(e=>e.text).join(" "));let r=l.map(e=>{if("image_url"===e.type){var t,a;let l=(null==(t=e.image_url)?void 0:t.url)||"",r=(0,m.sC)(l),o=(null==(a=e.image_url)?void 0:a.fileName)||"image";return"\n![".concat(o,"](").concat(r,")")}if("video"===e.type){let t=e.video||"",a=(0,m.sC)(t);return"\n[Video](".concat(a,")")}{let t=(0,m.UX)(e.file_url);return"\n".concat(t)}}).join("\n");r&&(c=c+"\n"+r)}let v=[...d&&d.id===w?[]:A,{role:"human",context:c,model_name:(null==t?void 0:t.model_name)||Y,order:D.current,time_stamp:0},{role:"view",context:"",model_name:(null==t?void 0:t.model_name)||Y,order:D.current,time_stamp:0,thinking:!0}],p=v.length-1;C([...v]),$({data:{user_input:e,team_mode:(null==P?void 0:P.team_mode)||"",app_config_code:(null==P?void 0:P.config_code)||"",conv_uid:w,ext_info:{vis_render:(null==P||null==(r=P.layout)||null==(l=r.chat_layout)?void 0:l.name)||"",incremental:(null==P||null==(n=P.layout)||null==(o=n.chat_layout)?void 0:o.incremental)||!1},...t},ctrl:u,chatId:w,onMessage:e=>{V(!0),e&&((null==t?void 0:t.incremental)?v[p].context+=e:v[p].context=e,v[p].thinking=!1,C([...v]))},onDone:()=>{J(!1),V(!1),a()},onClose:()=>{J(!1),V(!1),a()},onError:e=>{J(!1),V(!1),v[p].context=e,v[p].thinking=!1,C([...v]),a()}})}),[A,Y,$,P]);(0,i.A)(async()=>{if(et)return;let e=(0,m.oF)();(!e||e.id!==w)&&w&&await ed()},[w,ed,j]),(0,o.useEffect)(()=>{et&&(D.current=1,C([]))},[et]);let ev=(0,s.A)(ec,{wait:500});return(0,i.A)(async()=>{let e=(0,m.oF)();e&&e.id===w&&P&&(null==q?void 0:q.length)>0&&(ev.run(e.message,{app_code:null==P?void 0:P.app_code,...(null==q?void 0:q.length)&&{chat_in_params:q}}),el&&await el(),localStorage.removeItem(m.yx))},[w,(0,m.oF)(),P,q]),(0,l.jsx)(x.zo.Provider,{value:{history:A,replyLoading:O,scrollRef:S,canAbort:R,chartsData:E||[],agent:z,currentDialogue:es,appInfo:P,maxNewTokensValue:I,resourceValue:M,modelValue:Y,setModelValue:H,setResourceValue:U,setMaxNewTokensValue:K,setAppInfo:B,setAgent:F,setCanAbort:V,setReplyLoading:J,handleChat:ec,refreshDialogList:el,refreshHistory:em,refreshAppInfo:en,setHistory:C,isShowDetail:T,setChatInParams:G,chatInParams:q,faultTypeValue:L,setFaultTypeValue:Q,projectNameValue:W,setProjectNameValue:Z},children:(0,l.jsx)(p.A,{flex:1,children:(0,l.jsx)(c.A,{className:"bg-gradient-light bg-cover bg-center dark:bg-gradient-dark w-full",children:(0,l.jsx)(c.A,{className:"bg-transparent",children:et?(0,l.jsx)(g,{children:(0,l.jsx)(_,{})}):(0,l.jsx)(v.A,{spinning:ei,wrapperClassName:"w-full h-screen",children:(0,l.jsx)(g,{className:"flex flex-col h-full",children:(0,l.jsx)(u.A,{ref:S,ctrl:ee})})})})})})})}},28169:(e,t,a)=>{Promise.resolve().then(a.bind(a,16710))},86355:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var l=a(95155),r=a(91070),o=a(28867),n=a(47937),i=a(56939),s=a(98696),d=a(29300),u=a.n(d),m=a(35695),c=a(12115),v=a(91218);let p=function(e){let{bodyClassName:t,minRows:a=1,maxRows:d,sendClassName:p,cneterBtn:f=!0,isGoPath:x=!1,input:h=""}=e,{setCurrentDialogInfo:_}=(0,c.useContext)(r.UK),{t:g}=(0,v.Bd)(),b=(0,m.useRouter)(),[y,w]=(0,c.useState)(""),[j,N]=(0,c.useState)(!1),[k,S]=(0,c.useState)(!1),D=async()=>{let[,e]=await (0,o.Vb)((0,o.j_)({app_code:"chat_normal"}));e&&(localStorage.setItem(n.yx,JSON.stringify({id:e.conv_uid,message:y})),b.push("/chat/?app_code=chat_normal&conv_uid=".concat(e.conv_uid))),w("")};return(0,l.jsxs)("div",{className:u()("flex flex-1 h-12 p-2 pl-4 items-center justify-between bg-white dark:bg-[#242733] dark:border-[#6f7f95] rounded-xl border border-gray-300 ".concat(j?"border-[#0c75fc]":""),t),children:[(0,l.jsx)(i.A.TextArea,{placeholder:g("input_tips"),className:"w-full resize-none border-0 p-0 focus:shadow-none",value:y,autoSize:{minRows:a,maxRows:d},onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||k||(e.preventDefault(),y.trim()&&D()))},onChange:e=>{w(e.target.value)},onFocus:()=>{N(!0)},onBlur:()=>N(!1),onCompositionStart:()=>S(!0),onCompositionEnd:()=>S(!1)}),(0,l.jsx)(s.Ay,{type:"primary",className:u()("flex items-center justify-center w-20 h-10 rounded-xl text-sm font-semibold shadow-lg hover:shadow-xl transition-all duration-300 border-0",{"bg-gradient-to-r from-violet-500 via-cyan-500 to-emerald-500 hover:from-violet-600 hover:via-cyan-600 hover:to-emerald-600 hover:scale-105 text-white":y.trim(),"bg-gradient-to-r from-gray-300 to-gray-400 text-gray-500 cursor-not-allowed":!y.trim()}),onClick:()=>{y.trim()&&D()},children:g("sent")})]})}}},e=>{e.O(0,[562,240,5600,2826,7330,4935,4316,8779,3930,3485,5033,8052,3769,5726,2013,7316,6939,1242,5566,6467,2570,964,7985,797,2343,7744,7514,3821,6174,2275,5719,8118,6124,373,7741,2143,1070,4496,9622,1864,8441,5964,7358],()=>e(e.s=28169)),_N_E=e.O()}]);