(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6937],{23639:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>l});var o=a(95155),d=a(11518),t=a.n(d),i=a(12115),n=a(59622),s=a(91070);function l(){let[e,r]=(0,i.useState)(""),[a,d]=(0,i.useState)("all"),[l,c]=(0,i.useState)(!1),[p,b]=(0,i.useState)([]),[x,g]=(0,i.useState)({}),[f,u]=(0,i.useState)([]),[m,h]=(0,i.useState)({}),v=(0,i.useRef)(null),w=(0,i.useRef)(null),[k,j]=(0,i.useState)(""),[y,N]=(0,i.useState)({}),[S,M]=(0,i.useState)(!1),A=[{id:1,title:"\uD83D\uDCCA 组件状态汇总",tags:["summary"],body:"组件, 节点, 状态, 说明\napisix | 10.88.4.195, 10.88.4.196 | ❌ 异常 | SSL证书有效期无法获取，访问日志检查失败\nceph-osd | 10.88.4.193, 10.88.4.194, 10.88.4.195, 10.88.4.196 | ✅ 正常 | 所有OSD进程正常\nceph-mon | 10.88.4.193, 10.88.4.194, 10.88.4.195, 10.88.4.196 | ✅ 正常 | 集群健康状态正常\nmon_leader | 10.88.4.193, 10.88.4.194, 10.88.4.195, 10.88.4.196 | ✅ 正常 | 集群健康、容量正常\nslb | 10.88.4.197, 10.88.4.198 | ✅ 正常 | 仅存在YAML加载警告\nkeepalived | 10.88.4.197, 10.88.4.198 | ✅ 正常 | VIP正常，未发现异常\napisix访问日志 | 10.88.4.195, 10.88.4.196 | ❌ 异常 | 日志检查失败\nceph慢操作日志 | 10.88.4.193 | ❌ 异常 | 检查失败，可能有性能问题"},{id:2,title:"\uD83D\uDD27 异常信息详解 - SSL证书有效期检查失败",tags:["error","apisix","ssl"],body:'节点: 10.88.4.195, 10.88.4.196\n异常信息:\n{"changed": false, "msg": "无法获取证书有效期", "failed": true}\n可能原因:\n- 证书文件路径错误或权限不足\n- 证书文件损坏\n- openssl 未正确安装\n- 脚本未正确处理证书输出格式\n影响:\n- 无法预警证书过期，可能导致 HTTPS 服务中断\n建议操作:\n- 检查证书文件是否存在及权限是否正确\n- 确认证书已正确加载到 Nginx/Envoy 等服务\n- 在 Ansible 脚本中增加调试输出以确认 openssl 执行是否正常'},{id:3,title:"❌ Ceph慢操作日志异常",tags:["error","ceph","slow-ops"],body:"现象: ceph-slow-ops.log 检查失败（返回码1）\n节点: 10.88.4.193\nSOP:\n- 检查 ceph health 是否有告警\n- 查看 /var/log/ceph/ceph-slow-ops.log 内容\n- 优化存储性能:\n  * 检查 OSD 磁盘 I/O 负载，必要时加缓存/换硬件\n  * 调整 osd_max_split_time 等参数\n- 修改检查脚本逻辑（慢操作数量>阈值再报错）"},{id:4,title:"⚠️ SLB YAML兼容性警告",tags:["warning","slb","yaml"],body:"现象: slb 模块提示 YAML 格式兼容性问题\n节点: 10.88.4.197, 10.88.4.198\nSOP:\n- 检查 Ansible 版本是否支持当前 YAML 语法\n- 使用 yamllint 验证 YAML 文件\n- 更新脚本兼容性声明（添加标签/调整缩进）"}],C=[{id:1,title:"\uD83D\uDD0D 系统组件检查",tags:["component","runtime"],body:"Apisix 服务状态（10.88.4.195, 10.88.4.196）\n服务运行正常，但 SSL 证书检查存在问题\n状态: 异常\n详情: 证书有效期获取失败\n\nCeph 集群状态（10.88.4.193, .194, .195, .196）\n健康: HEALTH_OK\nOSD: 正常\nMON: 正常\n容量: 充足"},{id:2,title:"\uD83D\uDCCA 负载均衡检查",tags:["slb","keepalived"],body:"SLB 服务状态（10.88.4.197, 10.88.4.198）\n配置状态: 正常\n备注: 仅存在 YAML 加载警告，不影响服务\n\nKeepalived 高可用（10.88.4.197, 10.88.4.198）\nVIP: 正常\n故障转移: 配置正确\n心跳检测: 正常"},{id:3,title:"\uD83D\uDCCB 日志分析",tags:["logs","analysis"],body:"Apisix 访问日志（10.88.4.195, 10.88.4.196）\n检查: 失败\n错误: 无法访问或解析日志文件\n建议: 检查日志文件权限和路径配置\n\nCeph 慢操作日志（10.88.4.193）\n检查: 异常\n影响: 可能存在性能瓶颈\n建议: 检查存储性能与网络延迟"},{id:4,title:"\uD83C\uDFAF 性能指标",tags:["perf","metrics"],body:"CPU: 正常范围\n内存: 正常\n磁盘I/O: 部分节点存在慢操作\n网络延迟: 正常"}],L=e=>{navigator.clipboard.writeText(e).then(()=>{alert("已复制到剪贴板")})},_=function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3?arguments[3]:void 0;return new Promise(d=>{let t=0,i=setInterval(()=>{t+=1,r(e.slice(0,t)),o&&setTimeout(()=>{o.current&&(o.current.scrollTop=o.current.scrollHeight)},0),t>=e.length&&(clearInterval(i),d())},a)})},z=async()=>{c(!0),M(!0),b([]),g({}),u([]),h({}),await new Promise(e=>setTimeout(e,5e3)),M(!1);let e=[...A],r=[...C];(async()=>{for(let e of r)u(r=>[...r,e.id]),h(r=>({...r,[e.id]:""})),await _(e.body,r=>{h(a=>({...a,[e.id]:r}))},18,w);for(let r of e)b(e=>[...e,r.id]),g(e=>({...e,[r.id]:""})),await _(r.body,e=>{g(a=>({...a,[r.id]:e}))},18,v)})()};return(0,o.jsxs)(s.zo.Provider,{value:{scrollRef:{current:null},replyLoading:!1,handleChat:async()=>{},appInfo:{app_code:"intelligent-scripts",layout:{chat_in_layout:[{param_type:"resource",sub_type:"text_file"}]}},resourceValue:y,refreshDialogList:()=>{},chatInParams:[],setResourceValue:e=>{N(e),e&&"object"==typeof e&&"file_name"in e&&j(e.file_name)},history:[],canAbort:!1,currentDialogue:{},maxNewTokensValue:1e3,faultTypeValue:"",projectNameValue:"",setMaxNewTokensValue:()=>{},setFaultTypeValue:()=>{},setProjectNameValue:()=>{},refreshHistory:()=>{},setCanAbort:()=>{},setReplyLoading:()=>{},setChatInParams:()=>{},modelValue:"default",chartsData:[],agent:"",setModelValue:()=>{},setAppInfo:()=>{},setAgent:()=>{},refreshAppInfo:()=>{},setHistory:()=>{},isShowDetail:!0,setIsShowDetail:()=>{},isDebug:!1},children:[(0,o.jsx)(t(),{id:"4d1d29dbed77fb49",children:':root{--bg:#ffffff;--panel:#ffffff;--muted:#5f6b7b;--text:#1c2333;--accent:#2b6cff;--ring:#a8c0ff;--ok:#1f9d55;--warn:#b58900;--err:#e02424;--chip:#f3f6ff;--border:#e6e9f2;--code:#f7f9ff;--think:#f2f6ff;--think-border:#c8d6ff;--success:#dcfce7;--success-border:#16a34a;--warning:#fef3c7;--warning-border:#d97706;--error:#fecaca;--error-border:#dc2626}body{margin:0;background:var(--bg);color:var(--text);font:14px/1.6 "Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif}.app{width:98%!important;max-width:none!important;margin:10px!important;padding:10px!important}.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.06)}header.card{padding:18px 20px;display:flex;gap:12px;align-items:center;justify-content:space-between}h1{font-size:18px;margin:0}.controls{display:flex;gap:10px;flex-wrap:wrap}.chip{border:1px solid var(--border);background:var(--chip);color:var(--text);padding:6px 10px;border-radius:999px;display:inline-flex;align-items:center;gap:8px}.chip input,.chip select{border:none;background:transparent;color:inherit;outline:none}.chip button{all:unset;cursor:pointer;padding:2px 6px;border-radius:8px}.chip button:hover{background:#eef2ff}.toolbar{display:flex;gap:8px;flex-wrap:wrap}.btn{border:1px solid var(--border);background:#fff;padding:8px 12px;border-radius:12px;cursor:pointer}.btn:hover{border-color:var(--ring);background:#f7faff}.diagnosis-section .btn,.log-section .btn{padding:6px 10px;border-radius:10px;font-size:12px}.main-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:16px;height:calc(100vh - 60px)}.left-panel.card{padding:0;display:flex;flex-direction:column;height:100%;overflow:hidden}.right-panel.card{padding:0;display:flex;flex-direction:column;height:100%;overflow:hidden}.diagnosis-section{display:flex;flex-direction:column;height:100%;padding:16px;padding-bottom:0}.diagnosis-section h2{font-size:16px;margin:0 0 12px 0;color:var(--accent);border-bottom:2px solid var(--border);padding-bottom:8px;flex-shrink:0}.diagnosis-content{flex:1;display:flex;flex-direction:column;min-height:0}.scrollable-diagnosis{flex:1;overflow-y:scroll;min-height:0;padding-right:4px;scrollbar-gutter:stable both-edges}.scrollable-diagnosis::-webkit-scrollbar{width:6px}.scrollable-diagnosis::-webkit-scrollbar-track{background:transparent}.scrollable-diagnosis::-webkit-scrollbar-thumb{background:rgba(0,0,0,.1);border-radius:3px}.scrollable-diagnosis::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.2)}.status-summary{background:#fff;border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:16px}.status-table{width:100%;border-collapse:collapse;margin-bottom:16px}.status-table th{background:var(--chip);padding:8px 12px;text-align:left;font-weight:600;border:1px solid var(--border)}.status-table th:nth-child(3){width:100px;min-width:100px}.status-table td{padding:8px 12px;border:1px solid var(--border);vertical-align:top}.status-table td:nth-child(3){width:120px;min-width:120px}.status-normal{color:var(--ok);font-weight:600}.status-error{color:var(--err);font-weight:600}.status-warning{color:var(--warn);font-weight:600}.issue-item{background:#fff;border:1px solid var(--border);border-radius:12px;padding:16px;margin-bottom:12px}.issue-item.error{background:var(--error);border-color:var(--error-border)}.issue-item.warning{background:var(--warning);border-color:var(--warning-border)}.issue-title{font-weight:600;font-size:15px;margin-bottom:8px;display:flex;align-items:center;gap:8px}.issue-content{font-size:14px;line-height:1.5}.issue-list{margin:8px 0;padding-left:16px}.issue-list li{margin-bottom:4px}.diag-item{border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px;background:#fff;position:relative}.diag-item .tags{display:flex;gap:6px;margin-bottom:8px}.diag-item .content{white-space:pre-wrap;word-break:break-word;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:13.5px;background:#f8f9fa;padding:10px;border-radius:8px;border:1px solid var(--border);font-weight:normal;color:#495057}.log-section{display:flex;flex-direction:column;height:100%;padding:16px}.log-section h2{font-size:16px;margin:0 0 12px 0;color:var(--accent);border-bottom:2px solid var(--border);padding-bottom:8px;flex-shrink:0}.log-content{flex:1;display:flex;flex-direction:column;min-height:0}.scrollable-log{flex:1;overflow-y:scroll;min-height:0;padding-right:4px;scrollbar-gutter:stable both-edges}.scrollable-log::-webkit-scrollbar{width:6px}.scrollable-log::-webkit-scrollbar-track{background:transparent}.scrollable-log::-webkit-scrollbar-thumb{background:rgba(0,0,0,.1);border-radius:3px}.scrollable-log::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.2)}.module-item{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px;position:relative}.module-header{display:flex;align-items:center;gap:8px;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid var(--border)}.module-title{font-weight:600;font-size:14px}.module-status{padding:2px 8px;border-radius:12px;font-size:12px;font-weight:600}.module-status.success{background:var(--success);color:var(--ok)}.module-status.error{background:var(--error);color:var(--err)}.module-status.warning{background:var(--warning);color:var(--warn)}.check-item{margin-bottom:8px;padding:8px;background:var(--code);border-radius:8px;font-size:14px}.check-item strong{color:var(--accent)}.check-content{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:13px;background:#f8f9fa;padding:8px;border-radius:6px;margin-top:4px;white-space:pre-wrap;word-break:break-word;font-weight:normal;color:#495057}.node-info{font-size:12px;color:var(--muted);margin-bottom:4px}.status-badge{padding:2px 6px;border-radius:4px;font-size:11px;font-weight:600}.status-badge.ok{background:var(--success);color:var(--ok)}.status-badge.error{background:var(--error);color:var(--err)}.check-content code,.diag-item .content code,.inline-code{background:#f8f9fa;padding:2px 4px;border-radius:3px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-weight:normal;color:#495057;font-size:12px;border:1px solid#dee2e6}.copy-btn-top-right{position:absolute;top:8px;right:8px;padding:4px 8px;font-size:11px;border-radius:6px;background:#fff;border:1px solid var(--border);color:var(--text);cursor:pointer;z-index:10;transition:all.2s ease}.copy-btn-top-right:hover{border-color:var(--accent);background:var(--chip);color:var(--accent)}.chat-input-wrapper{padding:16px;flex-shrink:0}.waiting-message{text-align:center;padding:40px 20px;color:var(--muted)}.loading-spinner{width:40px;height:40px;border:3px solid#f3f3f3;border-top:3px solid var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 16px}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@media(max-width:1200px){.main-grid{grid-template-columns:1fr}}'}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 app",children:(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 main-grid",children:[(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 left-panel card",children:(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 diagnosis-section",children:[(0,o.jsx)("h2",{className:"jsx-4d1d29dbed77fb49",children:"\uD83C\uDFE5 诊断报告总览"}),(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 diagnosis-content",children:[(0,o.jsx)("div",{ref:v,className:"jsx-4d1d29dbed77fb49 scrollable-diagnosis",children:l?p.length>0?p.map(e=>{let r=A.find(r=>r.id===e),a=x[e]||"";return(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 diag-item",children:[(0,o.jsx)("button",{onClick:()=>L(a),className:"jsx-4d1d29dbed77fb49 btn copy-btn-top-right",children:"复制"}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 issue-title",children:r.title}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 tags",children:r.tags.map((e,r)=>(0,o.jsxs)("span",{className:"jsx-4d1d29dbed77fb49 tag",children:["#",e]},r))}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 "+"content ".concat((a&&(/(^\s*\{[\s\S]*\}\s*$)|(^\s*select\s+)|(^\s*SELECT\s+)|(^\s*-\s)/im.test(a)||a.includes("\n")),"")),children:a})]},e)}):(0,o.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-4d1d29dbed77fb49",children:"暂无诊断内容"}):(0,o.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-4d1d29dbed77fb49",children:"请在下方输入后点击发送以开始诊断"})}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 chat-input-wrapper",children:(0,o.jsx)(n.A,{ctrl:new AbortController,onSend:()=>z()})})]})]})}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 right-panel card",children:(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 log-section",children:[(0,o.jsx)("h2",{className:"jsx-4d1d29dbed77fb49",children:"\uD83D\uDCCB 日志与指标解析"}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 log-content",children:(0,o.jsx)("div",{ref:w,className:"jsx-4d1d29dbed77fb49 scrollable-log",children:l?S?(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 waiting-message",children:[(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 loading-spinner"}),(0,o.jsx)("p",{className:"jsx-4d1d29dbed77fb49",children:"正在分析您的请求，请稍候..."})]}):f.length>0?f.map(e=>{let r=C.find(r=>r.id===e),a=m[e]||"";return(0,o.jsxs)("div",{className:"jsx-4d1d29dbed77fb49 module-item",children:[(0,o.jsx)("button",{onClick:()=>L(a),className:"jsx-4d1d29dbed77fb49 btn copy-btn-top-right",children:"复制"}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 module-header",children:(0,o.jsx)("span",{className:"jsx-4d1d29dbed77fb49 module-title",children:r.title})}),(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 check-item",children:(0,o.jsx)("div",{className:"jsx-4d1d29dbed77fb49 check-content",children:a})})]},e)}):(0,o.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-4d1d29dbed77fb49",children:"暂无日志与指标解析"}):(0,o.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-4d1d29dbed77fb49",children:"请在左侧发送后开始解析"})})})]})})]})})]})}},39508:(e,r,a)=>{"use strict";a.d(r,{A:()=>n});var o=a(95155),d=a(7132),t=a(66766),i=a(12115);let n=(0,i.memo)(e=>{let{width:r,height:a,model:n}=e,s=(0,i.useMemo)(()=>(0,d.ZI)(n||"huggingface"),[n]);return n?(0,o.jsx)(t.default,{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:r||24,height:a||24,src:s,alt:"llm",priority:!0}):null})},55726:(e,r,a)=>{Promise.resolve().then(a.bind(a,23639))}},e=>{e.O(0,[8052,3769,5152,2013,7316,6939,5566,6467,2570,7514,3821,6174,7004,663,1070,9622,8441,5964,7358],()=>e(e.s=55726)),_N_E=e.O()}]);