(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8457],{14245:(e,t,a)=>{Promise.resolve().then(a.bind(a,16710))},16710:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var l=a(95155),r=a(28867),n=a(12115),o=a(54099),s=a(62471),i=a(50715),d=a(93640),u=a(9409),c=a(47937),m=a(86253),x=a(16467),p=a(17238),v=a(35695),h=a(91070),f=a(86355),b=a(6124),g=a(97540);function _(){let[e,t]=(0,n.useState)([]),a=(0,v.useRouter)();(0,n.useEffect)(()=>{s()},[]);let{run:s,loading:i}=(0,o.A)(async()=>{let[e,t]=await (0,r.Vb)((0,r.eH)({page:1,page_size:10,published:!0}));return t},{manual:!0,onSuccess:e=>{e&&t(e.app_list||[])}}),d=async e=>{let[,t]=await (0,r.Vb)((0,r.j_)({app_code:e.app_code}));t&&a.push("/chat/?app_code=".concat(e.app_code,"&conv_uid=").concat(t.conv_uid))};return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-violet-50 via-cyan-50 to-emerald-50 dark:from-slate-900 dark:via-violet-900 dark:to-emerald-900 relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,l.jsx)("div",{className:"absolute -top-32 -right-32 w-96 h-96 bg-gradient-to-br from-violet-400/40 to-cyan-500/30 rounded-full blur-3xl animate-pulse"}),(0,l.jsx)("div",{className:"absolute -bottom-40 -left-40 w-[32rem] h-[32rem] bg-gradient-to-tr from-emerald-400/35 to-teal-500/25 rounded-full blur-3xl animate-bounce"}),(0,l.jsx)("div",{className:"absolute top-1/4 right-1/3 w-80 h-80 bg-gradient-to-r from-cyan-300/30 to-violet-400/25 rounded-full blur-2xl animate-pulse delay-1000"}),(0,l.jsx)("div",{className:"absolute bottom-1/3 left-1/4 w-64 h-64 bg-gradient-to-br from-teal-300/35 to-emerald-400/30 rounded-full blur-xl animate-bounce delay-500"}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 bg-gradient-to-r from-violet-300/20 to-cyan-300/20 rounded-full blur-2xl animate-spin-slow"})]}),(0,l.jsx)("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-screen px-6 py-12",children:(0,l.jsxs)("div",{className:"w-full max-w-4xl mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-16",children:[(0,l.jsxs)("div",{className:"inline-flex items-center justify-center p-6 mb-6 bg-white/95 dark:bg-slate-800/95 backdrop-blur-xl rounded-2xl shadow-lg border border-white/40 dark:border-slate-600/40 hover:shadow-xl hover:scale-105 transition-all duration-500 group",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-violet-500 via-cyan-500 to-emerald-500 rounded-2xl mr-4 shadow-lg group-hover:rotate-12 transition-transform duration-500",children:(0,l.jsx)("span",{className:"text-xl",children:"\uD83E\uDD16"})}),(0,l.jsx)("div",{className:"text-left",children:(0,l.jsx)("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-violet-600 via-cyan-600 to-emerald-600 group-hover:scale-105 transition-transform duration-500",children:"OpsDiag私有云智能助手"})})]}),(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsx)("p",{className:"text-base md:text-lg text-slate-600 dark:text-slate-300 font-medium text-center",children:"智能运维 \xb7 私有部署 \xb7 7\xd724小时服务"})})]}),(0,l.jsx)("div",{className:"mb-16",children:(0,l.jsxs)("div",{className:"bg-white/95 dark:bg-slate-800/95 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/50 dark:border-slate-600/50 p-12 hover:shadow-3xl transition-all duration-500 hover:scale-[1.02] transform group",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 flex items-center",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-violet-500 to-cyan-500 rounded-2xl mr-4 shadow-lg group-hover:rotate-6 transition-transform duration-300",children:(0,l.jsx)("span",{className:"text-lg",children:"\uD83D\uDCAC"})}),"开始新的对话"]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,l.jsx)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"实时响应"})]})]}),(0,l.jsx)("p",{className:"text-base text-slate-600 dark:text-slate-300 mb-4",children:"\uD83D\uDE80 输入您的运维问题，我将为您提供专业的解决方案"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 mb-8",children:[(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-violet-100 to-violet-200 dark:from-violet-900/50 dark:to-violet-800/50 text-violet-700 dark:text-violet-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDD0D 系统监控"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-cyan-100 to-cyan-200 dark:from-cyan-900/50 dark:to-cyan-800/50 text-cyan-700 dark:text-cyan-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDD27 故障诊断"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/50 dark:to-emerald-800/50 text-emerald-700 dark:text-emerald-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"⚡ 性能优化"}),(0,l.jsx)("span",{className:"px-6 py-3 bg-gradient-to-r from-teal-100 to-teal-200 dark:from-teal-900/50 dark:to-teal-800/50 text-teal-700 dark:text-teal-300 rounded-2xl text-base font-semibold shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer",children:"\uD83D\uDEE1️ 安全防护"})]})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute -inset-2 bg-gradient-to-r from-violet-400 via-cyan-400 to-emerald-400 rounded-3xl blur opacity-25 group-hover:opacity-40 transition duration-1000"}),(0,l.jsx)(f.A,{bodyClassName:"relative min-h-[140px] bg-gradient-to-br from-violet-50/80 via-white to-cyan-50/80 dark:from-slate-700 dark:via-slate-600 dark:to-slate-600 border-2 border-violet-200 dark:border-violet-700 rounded-3xl shadow-inner focus-within:border-violet-400 dark:focus-within:border-violet-500 focus-within:shadow-xl transition-all duration-500 placeholder:text-slate-400",minRows:5,maxRows:10,cneterBtn:!1})]})]})}),e.length>0&&(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h3",{className:"text-xl font-semibold text-slate-700 dark:text-slate-200 flex items-center mb-2",children:[(0,l.jsx)("span",{className:"mr-2",children:"\uD83D\uDE80"}),"快速开始"]}),(0,l.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"选择一个应用快速开始对话"})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(0,l.jsx)(b.A,{className:"group cursor-pointer transition-all duration-300 hover:scale-105 hover:shadow-xl border-0 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm",styles:{body:{padding:"20px"}},onClick:()=>d(e),children:(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:e.icon?(0,l.jsx)("img",{src:e.icon,alt:e.app_name,className:"w-14 h-14 rounded-xl object-cover shadow-md"}):(0,l.jsx)("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 via-purple-500 to-indigo-600 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-md",children:e.app_name.charAt(0).toUpperCase()})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)(g.A,{title:e.app_name,placement:"top",children:(0,l.jsx)("h3",{className:"text-base font-semibold text-slate-800 dark:text-slate-100 truncate mb-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:e.app_name})}),(0,l.jsx)(g.A,{title:e.app_describe||"暂无描述",placement:"bottom",children:(0,l.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400 line-clamp-2 leading-relaxed",children:e.app_describe||"暂无描述"})})]})]})},e.app_code))})]})]})})]})}let{Content:y}=m.A;function w(){var e,t,a,f,b;let g=(0,v.useSearchParams)(),w=null!=(t=(null==g?void 0:g.get("conv_uid"))||(null==g?void 0:g.get("chatId")))?t:"",j=null!=(a=null==g?void 0:g.get("app_code"))?a:"",N=null!=(f=null==g?void 0:g.get("model"))?f:"",k=null!=(b=null==g?void 0:g.get("knowledge"))?b:"",D=(0,n.useRef)(null),S=(0,n.useRef)(1),[A,C]=(0,n.useState)([]),[E]=(0,n.useState)(),[O,R]=(0,n.useState)(!1),[V,z]=(0,n.useState)(!1),[F,J]=(0,n.useState)(""),[P,B]=(0,n.useState)({}),[I,K]=(0,n.useState)(.6),[M,U]=(0,n.useState)(4e3),[H,T]=(0,n.useState)(),[X,Y]=(0,n.useState)(""),[q,G]=(0,n.useState)(!0),[L,Q]=(0,n.useState)([]);(0,n.useRef)(null);let{chat:W,ctrl:Z}=(0,d.A)({app_code:j||""});(0,n.useEffect)(()=>{var e,t,a;if(null==P||null==(t=P.layout)||null==(e=t.chat_in_layout)?void 0:e.length){let e=null==P||null==(a=P.layout)?void 0:a.chat_in_layout,t=e.find(e=>"temperature"===e.param_type),l=e.find(e=>"max_new_tokens"===e.param_type),r=e.find(e=>"resource"===e.param_type),n=e.find(e=>"model"===e.param_type);K(Number(null==t?void 0:t.param_default_value)||.6),U(Number(null==l?void 0:l.param_default_value)||4e3),Y(N||(null==n?void 0:n.param_default_value)||""),T(k||(null==r?void 0:r.param_default_value)||null),Q([...t?[{param_type:"temperature",param_value:"string"==typeof(null==t?void 0:t.param_default_value)?null==t?void 0:t.param_default_value:JSON.stringify(null==t?void 0:t.param_default_value),sub_type:null==t?void 0:t.sub_type}]:[],...l?[{param_type:"max_new_tokens",param_value:"string"==typeof(null==l?void 0:l.param_default_value)?null==l?void 0:l.param_default_value:JSON.stringify(null==l?void 0:l.param_default_value),sub_type:null==l?void 0:l.sub_type}]:[],...r?[{param_type:"resource",param_value:"string"==typeof(null==r?void 0:r.param_default_value)?k||(null==r?void 0:r.param_default_value):JSON.stringify(k||(null==r?void 0:r.param_default_value)),sub_type:null==r?void 0:r.sub_type}]:[],...n?[{param_type:"model",param_value:"string"==typeof(null==n?void 0:n.param_default_value)?N||(null==n?void 0:n.param_default_value):JSON.stringify(N||(null==n?void 0:n.param_default_value)),sub_type:null==n?void 0:n.sub_type}]:[]])}},[null==P||null==(e=P.layout)?void 0:e.chat_in_layout,N]);let $=(0,n.useMemo)(()=>!w,[w]),{data:ee=[],refresh:et,loading:ea}=(0,o.A)(async()=>await (0,r.Vb)((0,r.b7)())),{run:el,refresh:er,loading:en}=(0,o.A)(async()=>await (0,r.Vb)((0,r.Y6)({app_code:j,building_mode:!1})),{manual:!0,onSuccess:e=>{let[,t]=e;B(t||{})}}),eo=(0,n.useMemo)(()=>{let[,e]=ee;return(null==e?void 0:e.find(e=>e.conv_uid===w))||{}},[w,ee]);(0,n.useEffect)(()=>{$||el()},[w,$,el,j]);let{run:es,loading:ei,refresh:ed}=(0,o.A)(async()=>await (0,r.Vb)((0,r.r)(w)),{manual:!0,onSuccess:e=>{let[,t]=e,a=null==t?void 0:t.filter(e=>"view"===e.role);a&&a.length>0&&(S.current=a[a.length-1].order+1),C(t||[])}}),eu=(0,n.useCallback)((e,t)=>new Promise(a=>{var l,r,n,o,s,i;let d=(0,c.oF)(),u=new AbortController;if(R(!0),A&&A.length>0){let e=null==A?void 0:A.filter(e=>"view"===e.role),t=null==A?void 0:A.filter(e=>"human"===e.role);S.current=((null==(s=e[e.length-1])?void 0:s.order)||(null==(i=t[t.length-1])?void 0:i.order))+1}let m="";if("string"==typeof e)m=e;else{let t=e.content||[],a=t.filter(e=>"text"===e.type),l=t.filter(e=>"text"!==e.type);a.length>0&&(m=a.map(e=>e.text).join(" "));let r=l.map(e=>{if("image_url"===e.type){var t,a;let l=(null==(t=e.image_url)?void 0:t.url)||"",r=(0,c.sC)(l),n=(null==(a=e.image_url)?void 0:a.fileName)||"image";return"\n![".concat(n,"](").concat(r,")")}if("video"===e.type){let t=e.video||"",a=(0,c.sC)(t);return"\n[Video](".concat(a,")")}{let t=(0,c.UX)(e.file_url);return"\n".concat(t)}}).join("\n");r&&(m=m+"\n"+r)}let x=[...d&&d.id===w?[]:A,{role:"human",context:m,model_name:(null==t?void 0:t.model_name)||X,order:S.current,time_stamp:0},{role:"view",context:"",model_name:(null==t?void 0:t.model_name)||X,order:S.current,time_stamp:0,thinking:!0}],p=x.length-1;C([...x]),W({data:{user_input:e,team_mode:(null==P?void 0:P.team_mode)||"",app_config_code:(null==P?void 0:P.config_code)||"",conv_uid:w,ext_info:{vis_render:(null==P||null==(r=P.layout)||null==(l=r.chat_layout)?void 0:l.name)||"",incremental:(null==P||null==(o=P.layout)||null==(n=o.chat_layout)?void 0:n.incremental)||!1},...t},ctrl:u,chatId:w,onMessage:e=>{z(!0),e&&((null==t?void 0:t.incremental)?x[p].context+=e:x[p].context=e,x[p].thinking=!1,C([...x]))},onDone:()=>{R(!1),z(!1),a()},onClose:()=>{R(!1),z(!1),a()},onError:e=>{R(!1),z(!1),x[p].context=e,x[p].thinking=!1,C([...x]),a()}})}),[A,X,W,P]);(0,s.A)(async()=>{if($)return;let e=(0,c.oF)();(!e||e.id!==w)&&w&&await es()},[w,es,j]),(0,n.useEffect)(()=>{$&&(S.current=1,C([]))},[$]);let ec=(0,i.A)(eu,{wait:500});return(0,s.A)(async()=>{let e=(0,c.oF)();e&&e.id===w&&P&&(null==L?void 0:L.length)>0&&(ec.run(e.message,{app_code:null==P?void 0:P.app_code,...(null==L?void 0:L.length)&&{chat_in_params:L}}),et&&await et(),localStorage.removeItem(c.yx))},[w,(0,c.oF)(),P,L]),(0,l.jsx)(h.zo.Provider,{value:{history:A,replyLoading:O,scrollRef:D,canAbort:V,chartsData:E||[],agent:F,currentDialogue:eo,appInfo:P,temperatureValue:I,maxNewTokensValue:M,resourceValue:H,modelValue:X,setModelValue:Y,setResourceValue:T,setTemperatureValue:K,setMaxNewTokensValue:U,setAppInfo:B,setAgent:J,setCanAbort:z,setReplyLoading:R,handleChat:eu,refreshDialogList:et,refreshHistory:ed,refreshAppInfo:er,setHistory:C,isShowDetail:q,setChatInParams:Q,chatInParams:L},children:(0,l.jsx)(p.A,{flex:1,children:(0,l.jsx)(m.A,{className:"bg-gradient-light bg-cover bg-center dark:bg-gradient-dark w-full",children:(0,l.jsx)(m.A,{className:"bg-transparent",children:$?(0,l.jsx)(y,{children:(0,l.jsx)(_,{})}):(0,l.jsx)(x.A,{spinning:en,wrapperClassName:"w-full h-screen",children:(0,l.jsx)(y,{className:"flex flex-col h-full",children:(0,l.jsx)(u.A,{ref:D,ctrl:Z})})})})})})})}},86355:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var l=a(95155),r=a(91070),n=a(28867),o=a(47937),s=a(56939),i=a(98696),d=a(29300),u=a.n(d),c=a(35695),m=a(12115),x=a(91218);let p=function(e){let{bodyClassName:t,minRows:a=1,maxRows:d,sendClassName:p,cneterBtn:v=!0,isGoPath:h=!1,input:f=""}=e,{setCurrentDialogInfo:b}=(0,m.useContext)(r.UK),{t:g}=(0,x.Bd)(),_=(0,c.useRouter)(),[y,w]=(0,m.useState)(""),[j,N]=(0,m.useState)(!1),[k,D]=(0,m.useState)(!1),S=async()=>{let[,e]=await (0,n.Vb)((0,n.j_)({app_code:"chat_normal"}));e&&(localStorage.setItem(o.yx,JSON.stringify({id:e.conv_uid,message:y})),_.push("/chat/?app_code=chat_normal&conv_uid=".concat(e.conv_uid))),w("")};return(0,l.jsxs)("div",{className:u()("flex flex-1 h-12 p-2 pl-4 items-center justify-between bg-white dark:bg-[#242733] dark:border-[#6f7f95] rounded-xl border border-gray-300 ".concat(j?"border-[#0c75fc]":""),t),children:[(0,l.jsx)(s.A.TextArea,{placeholder:g("input_tips"),className:"w-full resize-none border-0 p-0 focus:shadow-none",value:y,autoSize:{minRows:a,maxRows:d},onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||k||(e.preventDefault(),y.trim()&&S()))},onChange:e=>{w(e.target.value)},onFocus:()=>{N(!0)},onBlur:()=>N(!1),onCompositionStart:()=>D(!0),onCompositionEnd:()=>D(!1)}),(0,l.jsx)(i.Ay,{type:"primary",className:u()("flex items-center justify-center w-14 h-8 rounded-lg text-sm  bg-button-gradient border-0",{"opacity-40 cursor-not-allowed":!y.trim()}),onClick:()=>{y.trim()&&S()},children:g("sent")})]})}}},e=>{e.O(0,[562,240,5600,2826,7330,4935,4316,8779,3930,3485,5033,1846,4925,7985,797,6939,9595,2343,5566,6467,2570,7744,5887,2275,5719,9211,6174,8709,7942,7514,5532,1070,4496,5464,8441,5964,7358],()=>e(e.s=14245)),_N_E=e.O()}]);