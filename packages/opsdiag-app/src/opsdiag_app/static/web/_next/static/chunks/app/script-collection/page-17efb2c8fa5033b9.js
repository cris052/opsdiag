(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2927],{39508:(e,a,r)=>{"use strict";r.d(a,{A:()=>o});var n=r(95155),t=r(7132),i=r(66766),s=r(12115);let o=(0,s.memo)(e=>{let{width:a,height:r,model:o}=e,d=(0,s.useMemo)(()=>(0,t.ZI)(o||"huggingface"),[o]);return o?(0,n.jsx)(i.default,{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:a||24,height:r||24,src:d,alt:"llm",priority:!0}):null})},39677:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>d});var n=r(95155),t=r(11518),i=r.n(t),s=r(12115),o=r(59622);function d(){let[e,a]=(0,s.useState)(""),[r,t]=(0,s.useState)("collapsed"),d=e=>{navigator.clipboard.writeText(e).then(()=>{alert("已复制到剪贴板")})},l=[{id:1,title:"思考过程",tags:["think"],body:"需要补充更自动化的采集脚本，覆盖连通性（ping/traceroute）、KVM/OVS 状态、路由/iptables、防火墙和服务健康，并以结构化输出；必要时使用 -b 提权。",isThink:!0},{id:2,title:"日志查询脚本",tags:["commands"],body:'ansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "journalctl -u nova-compute --since \'1 hour ago\' --no-pager\'"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "grep -i \'error\\|fail\' /var/log/neutron/*"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "tail -n 150 /var/log/cinder/volume.log"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "grep -i \'401 Unauthorized\' /var/log/keystone/keystone.log"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "tail -n 100 /var/log/glance/glance-api.log"',isThink:!1},{id:3,title:"性能监控脚本",tags:["commands"],body:'ansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "vmstat 1 2"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "sar -u 1 5"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "iostat -x 1 5"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "nvidia-smi"  # 若为GPU节点\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "systemctl is-failed"',isThink:!1},{id:4,title:"网络拓扑查询脚本",tags:["commands"],body:'ansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "openstack network list"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "openstack subnet list"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "ovs-ofctl dump-flows br-int"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "virsh list --all"\nansible -i /apps/xunjian/work/bcec/hosts 10.88.4.65 -m shell -a "ip netns exec qdhcp-<network-id> arp -a"',isThink:!1}].filter(a=>{if("hidden"===r&&a.isThink)return!1;if(!e)return!0;try{let r=RegExp(e,"i");return r.test(a.title)||r.test(a.body)}catch(r){return(a.title+a.body).includes(e)}}),c=[{id:1,agent:"planner",title:"规划器分析结果",tags:["json","steps"],body:'{"locale":"zh-CN","has_enough_context":false,"thought":"用户报告广州宿主机10.88.4.65上的虚拟机无法连接。需要收集更多上下文信息以进行彻底的故障排除。","title":"广州宿主机10.88.4.65上的虚拟机无法连接的故障排除","steps":[{"need_search":true,"title":"检索宿主机和虚拟机的网络配置和状态","description":"需要收集宿主机10.88.4.65的网络接口配置（如IP地址、子网掩码、网关、路由表）、虚拟机的网络配置（如虚拟交换机设置、IP分配、防火墙规则）、以及相关的网络状态信息（如ARP表、ICMP响应、TCP连接状态）。此外，还需检查虚拟化平台（如VMware、KVM、Hyper-V）的特定配置和日志，以确定是否存在虚拟机管理程序级别的网络问题。","step_type":"rag_retrieval","execution_res":"none"},{"need_search":false,"title":"生成脚本以收集虚拟机和宿主机的系统日志和性能指标","description":"需要生成脚本以收集宿主机和虚拟机的系统日志（如/var/log/messages、/var/log/syslog、Windows事件日志）、虚拟化平台日志（如VMware的vpxd日志、KVM的libvirt日志）、以及性能指标（如CPU、内存、磁盘I/O、网络吞吐量）。此外，还需收集虚拟机的启动日志、虚拟机管理程序的连接状态、以及可能的错误代码或异常信息。","step_type":"script_generate","execution_res":"none"}]}'},{id:2,agent:"rag_container",title:"RAG检索结果",tags:["rag_retrieval"],body:"需要收集宿主机与虚拟机网络配置、状态与虚拟化平台日志等，详见上一步骤说明。"},{id:6,agent:"script_container",title:"脚本容器处理",tags:["script_generate"],body:"生成脚本收集系统日志、虚拟化平台日志与性能指标（CPU/内存/磁盘I/O/网络），并抓取启动日志与Hypervisor连接状态。"},{id:3,agent:"script_container_sql",title:"ECS数据库查询",tags:["SQL","ECS"],body:"select * from ECS.project where project_name = %s"},{id:5,agent:"script_container_sql",title:"CMDB数据库查询",tags:["SQL","CMDB"],body:"SELECT \n    d.`项目名称`,\n    d.`子系统名称`,\n    d.`内存配置-总量`,\n    d.`内存配置-大小`,\n    d.`CPU配置(物理核)-数量`,\n    d.`网卡-配置`,\n    d.`管理ip`,\n    d.`TOR1`,\n    d.`TOR2`,\n    n.`管理ip` AS 网络设备ip,\n    n.`设备类型`,\n    n.`网络层次`\nFROM \n    `device` d\nLEFT JOIN \n    `network` n\n    ON (n.`用途描述` = d.`TOR1`)\n    AND n.`项目名称` LIKE %s\nWHERE \n    d.`项目名称` LIKE %s \n    AND d.`管理ip` = %s;"},{id:7,agent:"script_container_sql",title:"ECS数据库查询结果",tags:["SQL","ECS","result"],body:"{'id': 1, 'project_name': '长春', 'bcec_group': 'harbor-sealer、k8s-master、k8s-node、nova-api、nova-compute、keystone、cinder-api、cinder-volume、glance、manila、HAproxy、amqp、bcmysql、bcmysql-manager、bcmysql-vip', 'os_group': 'basic、storage、nova-compute', 'bms_group': '', 'ansible_node': '10.88.2.9', 'log_rule': 'nova:/var/log/nova/\\ncinder:/var/log/cinder/\\n组件日志每日做一次切分，切分前格式nova-compute.log、切分后格式nova-compute.log-20250404.gz'}"},{id:4,agent:"rag_container_searcher",title:"知识库检索结果",tags:["KB","排障案例"],body:"（多条长文本，节选若干重点）\n- 时钟不同步导致产品部署失败 → 建议核对 NTP（例：ntpdate -u 10.88.2.137）\n- VNC 协议配置错误（https 改为 http）导致控制台访问失败\n- Bond 子卡未识别导致网络不通 → 重启网卡/节点恢复\n- MAC 漂移因迁移动作残留 UUID → 清理残留\n- 容器侧 TCP RST → nf_conntrack_tcp_be_liberal = 1\n- 系统盘 I/O 错误导致开机卡住 → 排查宿主磁盘/更换故障盘"}].filter(a=>{if(!e)return!0;try{let r=RegExp(e,"i");return r.test(a.title)||r.test(a.body)}catch(r){return(a.title+a.body).includes(e)}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i(),{id:"5a61c0295564a6dd",children:':root{--bg:#ffffff;--panel:#ffffff;--muted:#5f6b7b;--text:#1c2333;--accent:#2b6cff;--ring:#a8c0ff;--ok:#1f9d55;--warn:#b58900;--err:#e02424;--chip:#f3f6ff;--border:#e6e9f2;--code:#f7f9ff;--think:#f2f6ff;--think-border:#c8d6ff}body{margin:0;background:var(--bg);color:var(--text);font:14px/1.6 "Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif}.app{max-width:1400px;margin:28px auto;padding:0 16px}.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.06)}header.card{padding:18px 20px;display:flex;gap:12px;align-items:center;justify-content:space-between}h1{font-size:18px;margin:0}.controls{display:flex;gap:10px;flex-wrap:wrap}.chip{border:1px solid var(--border);background:var(--chip);color:var(--text);padding:6px 10px;border-radius:999px;display:inline-flex;align-items:center;gap:8px}.chip input,.chip select{border:none;background:transparent;color:inherit;outline:none}.chip button{all:unset;cursor:pointer;padding:2px 6px;border-radius:8px}.chip button:hover{background:#eef2ff}.toolbar{display:flex;gap:8px;flex-wrap:wrap}.btn{border:1px solid var(--border);background:#fff;padding:8px 12px;border-radius:12px;cursor:pointer}.btn:hover{border-color:var(--ring);background:#f7faff}.main-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:2px;height:calc(100vh - 50px)}.left-panel.card{padding:0;display:flex;flex-direction:column;height:100%;overflow:hidden}.right-panel.card{padding:0;display:flex;flex-direction:column;height:100%;overflow:hidden}.script-section{display:flex;flex-direction:column;height:100%;padding:16px;padding-bottom:0}.script-section h2{font-size:16px;margin:0 0 12px 0;color:var(--accent);border-bottom:2px solid var(--border);padding-bottom:8px;flex-shrink:0}.script-content{flex:1;display:flex;flex-direction:column;min-height:0}.chat-input-wrapper{padding:0;padding-right:4px;padding-bottom:16px;flex-shrink:0}.scrollable-script{flex:1;overflow-y:auto;min-height:0;padding-right:4px}.scrollable-script::-webkit-scrollbar{width:6px}.scrollable-script::-webkit-scrollbar-track{background:transparent}.scrollable-script::-webkit-scrollbar-thumb{background:rgba(0,0,0,.1);border-radius:3px}.scrollable-script::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.2)}.script-item{border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px;background:#fff}.script-item.think{background:var(--think);border:1px dashed var(--think-border)}.script-item h3{margin:0 0 8px 0;font-size:14px;font-weight:600;color:var(--accent)}.script-item .tags{display:flex;gap:6px;margin-bottom:8px}.script-item .content{white-space:pre-wrap;word-break:break-word;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:12.5px;background:var(--code);padding:10px;border-radius:8px;border:1px solid var(--border)}.other-agents{display:flex;flex-direction:column;height:100%;padding:16px;padding-bottom:0}.other-agents h2{font-size:16px;margin:0 0 12px 0;color:var(--accent);border-bottom:2px solid var(--border);padding-bottom:8px;flex-shrink:0}.other-content{flex:1;display:flex;flex-direction:column;min-height:0}.scrollable-other{flex:1;overflow-y:auto;min-height:0;padding-right:4px}.scrollable-other::-webkit-scrollbar{width:6px}.scrollable-other::-webkit-scrollbar-track{background:transparent}.scrollable-other::-webkit-scrollbar-thumb{background:rgba(0,0,0,.1);border-radius:3px}.scrollable-other::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.2)}.agent-row{display:flex;gap:12px;margin-bottom:12px;flex-wrap:wrap}.agent-item{flex:1;min-width:280px;border:1px solid var(--border);border-radius:12px;padding:12px;background:#fff}.agent-header{display:flex;align-items:center;gap:8px;margin-bottom:8px}.agent-title{font-weight:600;font-size:14px}.agent-content{font-size:13px;line-height:1.5;white-space:pre-wrap;word-break:break-word}.agent-content.code{background:var(--code);padding:8px;border-radius:6px;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:12px}.tag{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid var(--border);color:var(--muted);background:#fff}.think-badge{background:var(--think);color:var(--accent);font-weight:600;padding:2px 6px;border-radius:4px;font-size:11px}.dot{width:10px;height:10px;border-radius:50%;margin-right:6px}.dot.planner{background:linear-gradient(45deg,#7dd3fc,#60a5fa)}.dot.rag{background:linear-gradient(45deg,#a78bfa,#60a5fa)}.dot.script{background:linear-gradient(45deg,#34d399,#10b981)}.dot.sql{background:linear-gradient(45deg,#fbbf24,#ef4444)}.dot.search{background:linear-gradient(45deg,#f472b6,#f59e0b)}.dot.general{background:linear-gradient(45deg,#94a3b8,#64748b)}.footer{opacity:.7;text-align:center;padding:14px 0;font-size:12px}@media(max-width:1200px){.main-grid{grid-template-columns:1fr}}'}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd app",children:(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd main-grid",children:[(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd left-panel card",children:(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd script-section",children:[(0,n.jsx)("h2",{className:"jsx-5a61c0295564a6dd",children:"\uD83D\uDD27 脚本生成结果"}),(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd script-content",children:[(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd scrollable-script",children:l.length>0?l.map(e=>(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd "+"script-item ".concat(e.isThink?"think":""),children:[(0,n.jsxs)("h3",{className:"jsx-5a61c0295564a6dd",children:[e.isThink?"\uD83E\uDDE0 ":"",e.title]}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd tags",children:e.tags.map((e,a)=>(0,n.jsxs)("span",{className:"jsx-5a61c0295564a6dd tag",children:["#",e]},a))}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd content",children:e.body}),(0,n.jsx)("div",{style:{marginTop:"8px"},className:"jsx-5a61c0295564a6dd",children:(0,n.jsx)("button",{onClick:()=>d(e.body),className:"jsx-5a61c0295564a6dd btn",children:"复制内容"})})]},e.id)):(0,n.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-5a61c0295564a6dd",children:"暂无脚本生成结果"})}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd chat-input-wrapper",children:(0,n.jsx)(o.A,{ctrl:new AbortController})})]})]})}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd right-panel card",children:(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd other-agents",children:[(0,n.jsx)("h2",{className:"jsx-5a61c0295564a6dd",children:"\uD83E\uDD16 其他Agent结果"}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd other-content",children:(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd scrollable-other",children:c.length>0?c.map(e=>{var a,r;return(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd agent-row",children:(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd agent-item",children:[(0,n.jsxs)("div",{className:"jsx-5a61c0295564a6dd agent-header",children:[(0,n.jsx)("span",{className:"jsx-5a61c0295564a6dd "+"dot ".concat("planner"===(a=e.agent)?"planner":a.startsWith("rag")?"rag":a.startsWith("script_container_sql")?"sql":a.startsWith("script")?"script":"interrupt"===a?"search":"general")}),(0,n.jsx)("span",{className:"jsx-5a61c0295564a6dd agent-title",children:e.title})]}),(0,n.jsx)("div",{style:{marginBottom:"8px"},className:"jsx-5a61c0295564a6dd tags",children:e.tags.map((e,a)=>(0,n.jsxs)("span",{className:"jsx-5a61c0295564a6dd tag",children:["#",e]},a))}),(0,n.jsx)("div",{className:"jsx-5a61c0295564a6dd "+"agent-content ".concat((r=e.body)&&(/(^\s*\{[\s\S]*\}\s*$)|(^\s*select\s+)|(^\s*ansible\s+-i\b)|(^\s*SELECT\s+)/im.test(r)||r.includes("\n"))?"code":""),children:e.body}),(0,n.jsx)("div",{style:{marginTop:"8px"},className:"jsx-5a61c0295564a6dd",children:(0,n.jsx)("button",{onClick:()=>d(e.body),className:"jsx-5a61c0295564a6dd btn",children:"复制"})})]})},e.id)}):(0,n.jsx)("div",{style:{textAlign:"center",opacity:.7,padding:"20px"},className:"jsx-5a61c0295564a6dd",children:"暂无其他Agent结果"})})})]})})]})})]})}},42477:(e,a,r)=>{Promise.resolve().then(r.bind(r,39677))}},e=>{e.O(0,[8052,3769,5726,2013,7316,6939,5566,6467,2570,7514,3821,6174,1788,1070,9622,8441,5964,7358],()=>e(e.s=42477)),_N_E=e.O()}]);