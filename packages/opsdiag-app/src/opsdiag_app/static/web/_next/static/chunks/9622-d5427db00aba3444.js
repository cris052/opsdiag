"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9622],{59622:(e,l,a)=>{a.d(l,{A:()=>R});var t=a(95155),n=a(91070),r=a(53867),s=a(56939),o=a(98696),i=a(16467),u=a(29300),c=a.n(u),p=a(12115),m=a(91218),d=a(28867),_=a(14808),x=a(75839),y=a(44421),h=a(31511),v=a(97540),f=a(66766),j=a(68250),b=a(56200),g=a(1828),w=a(76174);let A=(0,p.memo)(e=>{var l,a;let{maxNewTokensValue:r,setMaxNewTokensValue:o}=e,{appInfo:i,chatInParams:u,setChatInParams:c}=(0,p.useContext)(n.zo),{t:d}=(0,m.Bd)(),_=(0,p.useMemo)(()=>(null==u?void 0:u.filter(e=>"max_new_tokens"!==e.param_type))||[],[u]),x=(0,p.useMemo)(()=>{var e,l;return null==i||null==(l=i.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"max_new_tokens"===e.param_type)},[null==i||null==(l=i.layout)?void 0:l.chat_in_layout]),y=(0,p.useMemo)(()=>{var e,l;return(null==i||null==(l=i.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==i||null==(a=i.layout)?void 0:a.chat_in_layout]),h=(0,p.useMemo)(()=>(null==x?void 0:x.param_render_type)==="string",[null==x?void 0:x.param_render_type]);if(!y.includes("max_new_tokens"))return(0,t.jsx)(v.A,{title:d("max_new_tokens_tip"),children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(j.A,{className:"text-xl cursor-not-allowed opacity-30"})})});let f=e=>{let l=e.target.value;c([..._,{param_type:"max_new_tokens",param_value:l,sub_type:null==x?void 0:x.sub_type}]),o(l)},A=e=>{null===e||isNaN(e)||(c([..._,{param_type:"max_new_tokens",param_value:JSON.stringify(e),sub_type:null==x?void 0:x.sub_type}]),o(e))},N=e=>{isNaN(e)||(c([..._,{param_type:"max_new_tokens",param_value:JSON.stringify(e),sub_type:null==x?void 0:x.sub_type}]),o(e))};return(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(b.A,{arrow:!1,trigger:["click"],placement:"topLeft",content:()=>(0,t.jsx)("div",{className:"flex items-center gap-2",children:h?(0,t.jsx)(s.A,{size:"small",className:"w-40",placeholder:"请输入内容",onChange:f,value:"string"==typeof r?r:""}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{className:"w-32",min:1,max:20480,step:1,onChange:N,value:"number"==typeof r?r:4e3}),(0,t.jsx)(w.A,{size:"small",className:"w-20",min:1,max:20480,step:1,onChange:A,value:"number"==typeof r?r:4e3})]})}),children:(0,t.jsx)(v.A,{title:h?"IP设置":d("max_new_tokens"),placement:"bottom",arrow:!1,children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(j.A,{})})})}),(0,t.jsx)("span",{className:"text-sm ml-2",children:r})]})});var N=a(92611),C=a(32013),k=a(39508);let S=(0,p.memo)(()=>{var e,l;let{modelList:a}=(0,p.useContext)(n.UK),{appInfo:r,modelValue:s,setModelValue:o,chatInParams:i,setChatInParams:u}=(0,p.useContext)(n.zo),{t:c}=(0,m.Bd)(),d=(0,p.useMemo)(()=>(null==i?void 0:i.filter(e=>"model"!==e.param_type))||[],[i]),_=(0,p.useMemo)(()=>{var e,l;return null==r||null==(l=r.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"model"===e.param_type)},[null==r||null==(e=r.layout)?void 0:e.chat_in_layout]);return(0,p.useMemo)(()=>{var e,l;return(null==r||null==(l=r.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==r||null==(l=r.layout)?void 0:l.chat_in_layout]).includes("model")?(0,t.jsx)(C.A,{value:s,placeholder:c("choose_model"),className:"h-8 w-42 rounded-1xl",onChange:e=>{(e=>{e&&(o(e),u([...d,{param_type:"model",param_value:e,sub_type:null==_?void 0:_.sub_type}]))})(e)},popupMatchSelectWidth:300,children:a.map(e=>(0,t.jsx)(C.A.Option,{children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(k.A,{model:e}),(0,t.jsx)("span",{className:"ml-2 overflow-hidden text-ellipsis whitespace-nowrap",children:e})]})},e))}):(0,t.jsx)(v.A,{title:c("model_tip"),children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,t.jsx)(N.A,{className:"text-xl cursor-not-allowed opacity-30"})})})});var M=a(92366),E=a(3475),z=a(92197),V=a(54099),B=a(62471),I=a(27514),O=a(35695);let T=["text_file","image_file"],F=(0,p.memo)(e=>{var l,a,r,s,o,i;let{fileList:u,setFileList:_,setLoading:x,fileName:y}=e,{setResourceValue:h,appInfo:f,chatInParams:j,setChatInParams:b,refreshHistory:g,refreshDialogList:w,modelValue:A,resourceValue:N}=(0,p.useContext)(n.zo),{maxNewTokensValue:k}=(0,p.useContext)(n.zo),S=(0,O.useSearchParams)(),F=null!=(s=null==S?void 0:S.get("scene"))?s:"",L=null!=(o=(null==S?void 0:S.get("conv_uid"))||(null==S?void 0:S.get("chatId")))?o:"",{t:J}=(0,m.Bd)(),[P,K]=(0,p.useState)([]),U=(0,p.useMemo)(()=>{var e,l;return(null==f||null==(l=f.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==f||null==(l=f.layout)?void 0:l.chat_in_layout]),D=(0,p.useMemo)(()=>{var e,l,a;return U.includes("resource")&&!T.includes(null==f||null==(a=f.layout)||null==(l=a.chat_in_layout)||null==(e=l.filter(e=>"resource"===e.param_type)[0])?void 0:e.sub_type)},[null==f||null==(a=f.layout)?void 0:a.chat_in_layout,U]),H=(0,p.useMemo)(()=>(null==j?void 0:j.filter(e=>"resource"!==e.param_type))||[],[j]),R=(0,p.useMemo)(()=>{var e,l;return null==f||null==(l=f.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"resource"===e.param_type)},[null==f||null==(r=f.layout)?void 0:r.chat_in_layout]),{run:W,loading:q}=(0,V.A)(async e=>await (0,d.Vb)((0,M.PS)([e])),{manual:!0,onSuccess:e=>{var l;let[,a]=e,t=null==a?void 0:a.find(e=>"resource"===e.param_type&&e.sub_type===(null==R?void 0:R.sub_type));t&&K(null!=(l=null==t?void 0:t.param_type_options)?l:[])}});(0,B.A)(async()=>{D&&R&&await W(R)},[D,R]);let G=(0,p.useMemo)(()=>{var e;return null==(e=P.map)?void 0:e.call(P,e=>({label:e.label,value:e.key}))},[P]);(0,p.useEffect)(()=>{if((null==j?void 0:j.length)>0&&R&&P.length>0){let e=j.find(e=>"resource"===e.param_type);e&&(null==e?void 0:e.param_value)&&((null==e?void 0:e.param_value.trim().startsWith("{"))||b([...H,{param_type:"resource",param_value:JSON.stringify(P.find(e=>e.key===N)),sub_type:null==R?void 0:R.sub_type}]))}},[j,R,P,b,N]);let Q=(0,p.useCallback)(async()=>{let e=new FormData;e.append("doc_files",null==u?void 0:u[0]),x(!0);let[l,a]=await (0,d.Vb)((0,d.o0)({convUid:L||"",chatMode:F||"chat_normal",data:e,model:A,maxNewTokensValue:"string"==typeof k?void 0:k,config:{timeout:36e5}})).finally(()=>{x(!1)});a&&(b([...H,{param_type:"resource",param_value:JSON.stringify(a),sub_type:null==R?void 0:R.sub_type}]),h(a),await g(),w&&await w())},[L,u,A,w,g,F,x,h]);if(!U.includes("resource"))return(0,t.jsx)(v.A,{title:J("extend_tip"),children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,t.jsx)(E.A,{className:"text-lg cursor-not-allowed opacity-30"})})});switch(null==R?void 0:R.sub_type){case"text_file":case"image_file":case"common_file":return(0,t.jsx)(I.A,{name:"file",accept:(e=>{switch(e){case"text_file":return".txt,.doc,.docx,.pdf,.md";case"image_file":return".jpg,.jpeg,.png,.gif,.bmp,.webp";case"audio_file":return".mp3,.wav,.ogg,.aac";case"video_file":return".mp4,.wav,.wav";default:return""}})(null==R?void 0:R.sub_type),fileList:u,showUploadList:!1,beforeUpload:(e,l)=>{null==_||_(l)},customRequest:Q,disabled:!!y,children:(0,t.jsx)(v.A,{title:J("file_tip"),arrow:!1,placement:"bottom",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)]",children:(0,t.jsx)(z.A,{className:c()("text-xl",{"cursor-pointer":!(y||(null==(i=u[0])?void 0:i.name))})})})})});default:return(0,t.jsx)(C.A,{value:N,className:"w-30 h-8 rounded-3xl",onChange:e=>{(e=>{e&&(h(e),b([...H,{param_type:"resource",param_value:JSON.stringify(P.find(l=>l.key===e)),sub_type:null==R?void 0:R.sub_type}]))})(e)},disabled:!!(null==R?void 0:R.bind_value),loading:q,options:G})}});var L=a(40010);let J=(0,p.memo)(e=>{var l,a;let{faultTypeValue:r,setFaultTypeValue:s}=e,{appInfo:o,chatInParams:i,setChatInParams:u}=(0,p.useContext)(n.zo),{t:c}=(0,m.Bd)(),[d,_]=(0,p.useState)(!1),x=(0,p.useMemo)(()=>(null==i?void 0:i.filter(e=>"fault_type"!==e.param_type))||[],[i]),y=(0,p.useMemo)(()=>{var e,l;return null==o||null==(l=o.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"fault_type"===e.param_type)},[null==o||null==(l=o.layout)?void 0:l.chat_in_layout]),h=(0,p.useMemo)(()=>{var e,l;return(null==o||null==(l=o.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==o||null==(a=o.layout)?void 0:a.chat_in_layout]),f=(0,p.useMemo)(()=>{var e;console.log("故障类型调试信息:",{appInfo:o,chat_in_layout:null==o||null==(e=o.layout)?void 0:e.chat_in_layout,fault_type:y,param_type_options:null==y?void 0:y.param_type_options});let l=(null==y?void 0:y.param_type_options)||[];return l.length>0&&"string"==typeof l[0]?l.map(e=>({label:e,value:e})):l.length>0&&l[0].label&&l[0].value?l:0===l.length?[{label:"网络故障",value:"网络故障"},{label:"存储故障",value:"存储故障"},{label:"计算故障",value:"计算故障"}]:l},[null==y?void 0:y.param_type_options,o]);if(!h.includes("fault_type"))return(0,t.jsx)(v.A,{title:"故障类型",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(L.A,{className:"text-xl cursor-not-allowed opacity-30"})})});let j=(0,t.jsxs)("div",{className:"w-64 p-2",children:[(0,t.jsx)("div",{className:"mb-2 text-sm font-medium",children:"选择故障类型"}),(0,t.jsx)(C.A,{value:r,onChange:e=>{s(e),u([...x,{param_type:"fault_type",param_value:e,sub_type:""}]),_(!1)},options:f,placeholder:"请选择故障类型",className:"w-full",size:"middle"})]});return(0,t.jsx)(b.A,{content:j,title:null,trigger:"click",open:d,onOpenChange:_,placement:"topLeft",arrow:!1,children:(0,t.jsx)(v.A,{title:"故障类型",placement:"bottom",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(L.A,{className:"text-xl ".concat(r?"text-[#0c75fc]":"")})})})})});var P=a(99257);let K=(0,p.memo)(e=>{var l,a;let{projectNameValue:r,setProjectNameValue:s}=e,{appInfo:o,chatInParams:i,setChatInParams:u}=(0,p.useContext)(n.zo),{t:c}=(0,m.Bd)(),[d,_]=(0,p.useState)(!1),x=(0,p.useMemo)(()=>(null==i?void 0:i.filter(e=>"project_name"!==e.param_type))||[],[i]),y=(0,p.useMemo)(()=>{var e,l;return null==o||null==(l=o.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"project_name"===e.param_type)},[null==o||null==(l=o.layout)?void 0:l.chat_in_layout]),h=(0,p.useMemo)(()=>{var e,l;return(null==o||null==(l=o.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==o||null==(a=o.layout)?void 0:a.chat_in_layout]),f=(0,p.useMemo)(()=>{let e=(null==y?void 0:y.param_type_options)||[];return e.length>0&&"string"==typeof e[0]?e.map(e=>({label:e,value:e})):e.length>0&&e[0].label&&e[0].value?e:0===e.length?[{label:"重庆健康云ECS",value:"重庆健康云ECS"},{label:"长春政务云ECS",value:"长春政务云ECS"},{label:"新疆石河子ECS",value:"新疆石河子ECS"}]:e},[null==y?void 0:y.param_type_options,o]);if(!h.includes("project_name"))return(0,t.jsx)(v.A,{title:"项目名称",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(P.A,{className:"text-xl cursor-not-allowed opacity-30"})})});let j=(0,t.jsxs)("div",{className:"w-64 p-2",children:[(0,t.jsx)("div",{className:"mb-2 text-sm font-medium",children:"选择项目名称"}),(0,t.jsx)(C.A,{value:r,onChange:e=>{s(e),u([...x,{param_type:"project_name",param_value:e,sub_type:""}]),_(!1)},options:f,placeholder:"请选择项目名称",className:"w-full",size:"middle"})]});return(0,t.jsx)(b.A,{content:j,title:null,trigger:"click",open:d,onOpenChange:_,placement:"topLeft",arrow:!1,children:(0,t.jsx)(v.A,{title:"项目名称",placement:"bottom",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] cursor-pointer",children:(0,t.jsx)(P.A,{className:"text-xl ".concat(r?"text-[#0c75fc]":"")})})})})});var U=a(47937);let D=(0,p.memo)(e=>{var l,a;let{ctrl:s}=e,{t:o}=(0,m.Bd)(),{history:u,scrollRef:j,canAbort:b,replyLoading:g,currentDialogue:w,appInfo:N,maxNewTokensValue:C,resourceValue:k,faultTypeValue:M,projectNameValue:E,setMaxNewTokensValue:z,setFaultTypeValue:V,setProjectNameValue:B,refreshHistory:I,setCanAbort:T,setReplyLoading:L,handleChat:P,chatInParams:D,setChatInParams:H,setResourceValue:R}=(0,p.useContext)(n.zo),[W,q]=(0,p.useState)([]),[G,Q]=(0,p.useState)(!1),[X,Y]=(0,p.useState)(!1),Z=(0,O.useSearchParams)(),$=null!=(a=null==Z?void 0:Z.get("conv_uid"))?a:"",ee=(0,p.useMemo)(()=>{var e,l;return(null==N||null==(l=N.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==N||null==(l=N.layout)?void 0:l.chat_in_layout]),el=(0,p.useMemo)(()=>[{tip:o("stop_replying"),icon:(0,t.jsx)(_.A,{className:c()({"text-[#0c75fc]":b})}),can_use:b,key:"abort",onClick:()=>{b&&((0,d.vc)({conv_session_id:$}),s&&s.abort(),setTimeout(()=>{T(!1),L(!1)},100))}},{tip:o("answer_again"),icon:(0,t.jsx)(x.A,{}),can_use:!g&&u.length>0,key:"redo",onClick:async()=>{var e,l;let a=null==(l=u.filter(e=>"human"===e.role))||null==(e=l.slice(-1))?void 0:e[0];P((null==a?void 0:a.context)||"",{app_code:N.app_code,...ee.length&&{chat_in_params:D}}),setTimeout(()=>{var e,l;null==(l=j.current)||l.scrollTo({top:null==(e=j.current)?void 0:e.scrollHeight,behavior:"smooth"})},0)}},{tip:o("erase_memory"),icon:X?(0,t.jsx)(i.A,{spinning:X,indicator:(0,t.jsx)(r.A,{style:{fontSize:20}})}):(0,t.jsx)(y.A,{}),can_use:u.length>0,key:"clear",onClick:async()=>{X||(Y(!0),await (0,d.Vb)((0,d.CK)($)).finally(async()=>{await I(),Y(!1)}))}}],[o,b,g,u,X,s,T,L,P,N.app_code,ee,k,null==w?void 0:w.select_param,null==w?void 0:w.conv_uid,j,I]),ea=(0,p.useMemo)(()=>{try{if(k)if("string"==typeof k)return JSON.parse(k).file_name||"";else return k.file_name||""}catch(e){return""}},[k]);return(0,t.jsxs)("div",{className:"flex flex-col  mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-full w-full",children:[(0,t.jsxs)("div",{className:"flex gap-3 text-lg",children:[(0,t.jsx)(S,{}),(0,t.jsx)(F,{fileList:W,setFileList:q,setLoading:Q,fileName:ea}),(0,t.jsx)(A,{maxNewTokensValue:C,setMaxNewTokensValue:z}),(0,t.jsx)(J,{faultTypeValue:M,setFaultTypeValue:V}),(0,t.jsx)(K,{projectNameValue:E,setProjectNameValue:B})]}),(0,t.jsx)("div",{className:"flex gap-1",children:(0,t.jsx)(t.Fragment,{children:el.map(e=>(0,t.jsx)(v.A,{title:e.tip,arrow:!1,placement:"bottom",children:(0,t.jsx)("div",{className:"flex w-8 h-8 items-center justify-center rounded-md hover:bg-[rgb(221,221,221,0.6)] text-lg ".concat(e.can_use?"cursor-pointer":"opacity-30 cursor-not-allowed"),onClick:()=>{var l;null==(l=e.onClick)||l.call(e)},children:e.icon})},e.key))})})]}),(0,t.jsx)(()=>{var e;let l=k&&(0,U.nr)(k)||[];if(0===l.length)return null;let a=(0,p.useMemo)(()=>(null==D?void 0:D.filter(e=>"resource"!==e.param_type))||[],[D]),n=(0,p.useMemo)(()=>{var e,l;return null==N||null==(l=N.layout)||null==(e=l.chat_in_layout)?void 0:e.find(e=>"resource"===e.param_type)},[null==N||null==(e=N.layout)?void 0:e.chat_in_layout]);return(0,t.jsx)("div",{className:"group/item flex flex-wrap gap-2 mt-2",children:l.map((e,l)=>{var r,s;let o=()=>{R(null);let e=D.find(e=>"resource"===e.param_type);e&&(null==e?void 0:e.param_value)&&H([...a,{param_type:"resource",param_value:"",sub_type:null==n?void 0:n.sub_type}])};if("image_url"===e.type&&(null==(r=e.image_url)?void 0:r.url))return(e=>{let{item:l,handleDelete:a,index:n}=e,r=l.image_url.file_name,s=(0,U.sC)(l.image_url.url);return s?(0,t.jsxs)("div",{className:"relative flex flex-col border border-[#e3e4e6] dark:border-[rgba(255,255,255,0.6)] rounded-lg p-2",children:[(0,t.jsx)("span",{className:"absolute top-[-2px] right-[1] cursor-pointer z-10 text-gray-500",onClick:a,title:"删除",children:(0,t.jsx)(h.A,{})}),(0,t.jsx)("div",{className:"w-32 h-32 mb-2 overflow-hidden flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded",children:(0,t.jsx)("img",{src:s,alt:r||"Preview",className:"max-w-full max-h-full object-contain"})}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"text-sm text-[#1c2533] dark:text-white line-clamp-1",children:r})})]},"img-".concat(n)):null})({item:e,handleDelete:o,index:l});if("file_url"===e.type&&(null==(s=e.file_url)?void 0:s.url)){let a=e.file_url.file_name;return(0,t.jsxs)("div",{className:"relative flex items-center justify-between border border-[#e3e4e6] dark:border-[rgba(255,255,255,0.6)] rounded-lg py-2 px-3",children:[(0,t.jsx)("span",{className:"absolute top-[-2px] right-[1] cursor-pointer z-10 text-gray-500",onClick:o,title:"删除",children:(0,t.jsx)(h.A,{})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(f.default,{src:"/icons/chat/file.png",width:20,height:20,alt:"file-icon",className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-[#1c2533] dark:text-white line-clamp-1",children:a})]})]},"file-".concat(l))}return null})})},{}),(0,t.jsx)(i.A,{spinning:G,indicator:(0,t.jsx)(r.A,{style:{fontSize:24},spin:!0})})]})});var H=a(71740);let R=(0,p.memo)(e=>{var l;let{ctrl:a}=e,{t:u}=(0,m.Bd)(),{scrollRef:d,replyLoading:_,handleChat:x,appInfo:y,resourceValue:h,refreshDialogList:v,chatInParams:f,setResourceValue:j}=(0,p.useContext)(n.zo),[b,g]=(0,p.useState)(""),[w,A]=(0,p.useState)(!1),[N,C]=(0,p.useState)(!1),k=(0,p.useRef)(0),S=(0,p.useMemo)(()=>{var e,l;return(null==y||null==(l=y.layout)||null==(e=l.chat_in_layout)?void 0:e.map(e=>e.param_type))||[]},[null==y||null==(l=y.layout)?void 0:l.chat_in_layout]),M=async()=>{var e,l;let a;if(k.current++,setTimeout(()=>{var e,l;null==(l=d.current)||l.scrollTo({top:null==(e=d.current)?void 0:e.scrollHeight,behavior:"smooth"}),g("")},0),H.O.includes(null!=(l=null==(e=f.find(e=>"resource"===e.param_type))?void 0:e.sub_type)?l:"")){j(h||null);let e=[...(0,U.nr)(h)];e.push({type:"text",text:b}),a={role:"user",content:e}}else a=b;await x(a,{app_code:y.app_code||"",...S.length&&{chat_in_params:f}}),1===k.current&&v&&await v()};return(0,t.jsx)("div",{className:"flex flex-col w-full mx-auto pt-4 pb-0 bg-transparent",children:(0,t.jsxs)("div",{className:"flex flex-1 flex-col bg-white dark:bg-[rgba(255,255,255,0.16)] px-5 py-4 pt-2 rounded-xl relative border border-[#E0E7F2] dark:border-[rgba(255,255,255,0.6)] ".concat(w?"border-[#0c75fc]":""),id:"input-panel",children:[(0,t.jsx)(D,{ctrl:a}),(0,t.jsx)(s.A.TextArea,{placeholder:u("input_tips"),className:"w-full h-10 resize-none border-0 p-0 focus:shadow-none dark:bg-transparent",value:b,onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey||N||(e.preventDefault(),b.trim()&&!_&&M()))},onChange:e=>{g(e.target.value)},onFocus:()=>{A(!0)},onBlur:()=>A(!1),onCompositionStart:()=>C(!0),onCompositionEnd:()=>C(!1)}),(0,t.jsx)(o.Ay,{type:"primary",className:c()("flex items-center justify-center w-14 h-8 rounded-lg text-sm absolute right-4 bottom-3 bg-button-gradient border-0",{"cursor-not-allowed":!b.trim()}),onClick:()=>{!_&&b.trim()&&M()},children:_?(0,t.jsx)(i.A,{spinning:_,indicator:(0,t.jsx)(r.A,{className:"text-white"})}):u("sent")})]})})})},71740:(e,l,a)=>{a.d(l,{A:()=>p,O:()=>c});var t=a(95155),n=a(19361),r=a(74947),s=a(32570),o=a(32013),i=a(56939),u=a(12115);let c=["image_file","video_file","text_file","common_file"],p=u.memo(function(e){let{form:l,selectedChatConfigs:a,chatConfigOptions:u,onInputBlur:p,resourceOptions:m,modelOptions:d}=e;if(!a||0===a.length)return null;let _={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};return(0,t.jsx)(t.Fragment,{children:null==a?void 0:a.map(e=>{var a,x=null==u?void 0:u.find(l=>l.param_type===e);if(!x)return null;switch(x.param_type){case"model":return(0,t.jsxs)(n.A,{gutter:24,children:[(0,t.jsx)(r.A,{span:14,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:x.param_type,labelCol:{flex:"80px"},children:(0,t.jsx)(o.A,{className:"h-10",options:(null==(a=x.sub_types)?void 0:a.map(e=>({value:e,label:e})))||[],disabled:!x.sub_types,placeholder:"请选择".concat(x.param_description),onBlur:()=>p("".concat(x.param_type,"_value"))})})},"".concat(x.param_type,"-col1")),(0,t.jsx)(r.A,{span:10,children:(0,t.jsx)(s.A.Item,{name:"".concat(x.param_type,"_value"),initialValue:x.param_default_value,children:(0,t.jsx)(o.A,{options:d,placeholder:"请输入".concat(x.param_description),className:"h-10 flex-1"})})},"".concat(x.param_type,"-col2"))]},x.param_type);case"temperature":return(0,t.jsxs)(n.A,{gutter:24,children:[(0,t.jsx)(r.A,{span:14,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:x.param_type,labelCol:{flex:"80px"},children:(0,t.jsx)(i.A,{type:"number",step:"0.01",disabled:!x.sub_types,placeholder:"请输入".concat(x.param_description),className:"h-10"})})},"".concat(x.param_type,"-col1")),(0,t.jsx)(r.A,{span:10,children:(0,t.jsx)(s.A.Item,{name:"".concat(x.param_type,"_value"),initialValue:x.param_default_value,children:(0,t.jsx)(i.A,{type:"number",step:"0.01",placeholder:"请输入".concat(x.param_description),className:"h-10",onBlur:()=>p("".concat(x.param_type,"_value"))})})},"".concat(x.param_type,"-col2"))]},x.param_type);case"max_new_tokens":return(0,t.jsxs)(n.A,{gutter:24,children:[(0,t.jsx)(r.A,{span:14,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:x.param_type,labelCol:{flex:"80px"},children:(0,t.jsx)(i.A,{type:"text",disabled:!x.sub_types,placeholder:"请输入".concat(x.param_description),className:"h-10"})})},"".concat(x.param_type,"-col1")),(0,t.jsx)(r.A,{span:10,children:(0,t.jsx)(s.A.Item,{name:"".concat(x.param_type,"_value"),initialValue:x.param_default_value,children:(0,t.jsx)(i.A,{type:"text",placeholder:"请输入".concat(x.param_description),className:"h-10",onBlur:()=>p("".concat(x.param_type,"_value"))})})},"".concat(x.param_type,"-col2"))]},x.param_type);case"resource":return(0,t.jsxs)(n.A,{gutter:24,children:[(0,t.jsx)(r.A,{span:14,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:"".concat(x.param_type,"_sub_type"),labelCol:{flex:"80px"},children:(0,t.jsx)(o.A,{className:"h-10",options:x.sub_types&&x.sub_types.map(e=>({value:e,label:e}))||[],placeholder:"请选择".concat(x.param_description)})})},"".concat(x.param_type,"-col1")),(0,t.jsx)(r.A,{span:10,children:(0,t.jsx)(s.A.Item,{name:"".concat(x.param_type,"_value"),children:(0,t.jsx)(o.A,{options:m,className:"flex-1 h-10",placeholder:"请输入资源",disabled:c.includes(l.getFieldValue("".concat(x.param_type,"_sub_type")))})})},"".concat(x.param_type,"-col2"))]},x.param_type);case"fault_type":let y=x.param_type_options&&x.param_type_options.length>0?x.param_type_options:[{label:"网络故障",value:"网络故障"},{label:"存储故障",value:"存储故障"},{label:"计算故障",value:"计算故障"}];return(0,t.jsx)(n.A,{gutter:24,children:(0,t.jsx)(r.A,{span:24,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:"".concat(x.param_type,"_value"),labelCol:{flex:"80px"},initialValue:x.param_default_value||"网络故障",children:(0,t.jsx)(o.A,{options:y,className:"h-10",placeholder:"请选择故障类型",onBlur:()=>p("".concat(x.param_type,"_value"))})})},"".concat(x.param_type,"-col1"))},x.param_type);case"project_name":let h=x.param_type_options&&x.param_type_options.length>0?x.param_type_options:[{label:"重庆健康云ECS",value:"重庆健康云ECS"},{label:"长春政务云ECS",value:"长春政务云ECS"},{label:"新疆石河子ECS",value:"新疆石河子ECS"}];return(0,t.jsx)(n.A,{gutter:24,children:(0,t.jsx)(r.A,{span:24,children:(0,t.jsx)(s.A.Item,{label:(0,t.jsx)("span",{style:_,title:x.param_description,children:x.param_description}),name:"".concat(x.param_type,"_value"),labelCol:{flex:"80px"},initialValue:x.param_default_value||"项目名称",children:(0,t.jsx)(o.A,{options:h,className:"h-10",placeholder:"请选择项目名称",onBlur:()=>p("".concat(x.param_type,"_value"))})})},"".concat(x.param_type,"-col1"))},x.param_type);default:return null}})})})}}]);