(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2283],{2785:()=>{},23407:()=>{},53132:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>P});var s=l(95155),t=l(91070),n=l(28867),i=l(84182),r=l(64227),c=l(3377),d=l(44261),o=l(86050),p=l(54099),u=l(50715),m=l(55887),x=l(94326),h=l(16467),g=l(3795),f=l(56939),b=l(98696),v=l(56200),_=l(37974),j=l(7744),w=l(82940),N=l.n(w),y=l(35695),A=l(12115),k=l(91218),C=l(32570),S=l(57845),V=l(96194);l(29300);var E=l(66766);l(23407);let T=[{value:"/icons/colorful-plugin.png",label:"agent0"},{value:"/agents/agent1.jpg",label:"agent1"},{value:"/agents/agent2.jpg",label:"agent2"},{value:"/agents/agent3.jpg",label:"agent3"},{value:"/agents/agent4.jpg",label:"agent4"},{value:"/agents/agent5.jpg",label:"agent5"}],z=e=>{let{open:a,onCancel:l,type:t="add",refresh:i}=e,{notification:r}=m.A.useApp(),[c,d]=(0,A.useState)("/icons/colorful-plugin.png"),{t:o,i18n:u}=(0,k.Bd)(),x=JSON.parse(localStorage.getItem("new_app_info")||"{}"),{message:g}=m.A.useApp(),[b]=C.A.useForm(),v=(0,y.useRouter)(),{data:_,loading:j}=(0,p.A)(async()=>{let[e,a]=await (0,n.Vb)((0,n.Xr)());return null!=a?a:[]}),{run:w,loading:N}=(0,p.A)(async e=>"edit"===t?await (0,n.Vb)((0,n.fy)({app_code:null==x?void 0:x.app_code,language:"zh",...e})):await (0,n.Vb)((0,n.$q)({language:"zh",...e}),r),{manual:!0,onSuccess:async e=>{let[a,s]=e;if(a)g.error("edit"===t?o("Update_failure"):o("Create_failure"));else if("edit"===t){var r;let[,e]=await (0,n.Vb)((0,n.eH)({})),a=null==e||null==(r=e.app_list)?void 0:r.find(e=>e.app_code===(null==x?void 0:x.app_code));localStorage.setItem("new_app_info",JSON.stringify({...a,isEdit:!0})),g.success(o("Update_successfully"))}else(null==s?void 0:s.app_code)?(g.success(o("Create_successfully")),v.replace("/application/structure/?app_code=".concat(null==s?void 0:s.app_code))):g.error(o("Create_failure"));await (null==i?void 0:i()),l()}}),z=(0,A.useMemo)(()=>{var e;return null==_||null==(e=_.filter(e=>e.value===(null==x?void 0:x.team_mode)))?void 0:e[0]},[x,_]);return j?null:(0,s.jsx)(S.Ay,{theme:{components:{Button:{defaultBorderColor:"#d9d9d9"}}},children:(0,s.jsx)(V.A,{className:"create-app-modal-container",title:o("create_app"),width:480,open:a,onOk:async()=>{b.validateFields().then(async e=>{var a;await w({app_name:null==e?void 0:e.app_name,app_describe:null==e?void 0:e.app_describe,team_mode:null==e||null==(a=e.team_mode)?void 0:a.value,icon:(null==e?void 0:e.icon)||c})})},onCancel:l,centered:!0,children:(0,s.jsx)(h.A,{spinning:N,children:(0,s.jsx)("div",{className:"flex flex-1",children:(0,s.jsxs)(C.A,{layout:"vertical",className:"w-full",form:b,initialValues:{team_mode:z||(null==_?void 0:_[0]),app_name:null==x?void 0:x.app_name,app_describe:null==x?void 0:x.app_describe},children:[(0,s.jsx)(C.A.Item,{label:"".concat(o("app_name"),"："),name:"app_name",required:!0,rules:[{required:!0,message:o("input_app_name")}],children:(0,s.jsx)(f.A,{placeholder:o("input_app_name"),autoComplete:"off",className:"h-8"})}),(0,s.jsx)(C.A.Item,{label:"".concat(o("Description"),"："),name:"app_describe",required:!0,rules:[{required:!0,message:o("Please_input_the_description")}],children:(0,s.jsx)(f.A.TextArea,{autoComplete:"off",placeholder:o("Please_input_the_description"),autoSize:{minRows:2.5}})}),(0,s.jsx)(C.A.Item,{label:"".concat(o("App_icon")),name:"icon",children:(0,s.jsxs)("div",{className:"flex items-end gap-4",children:[(0,s.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,s.jsx)(E.default,{src:c,width:48,height:48,alt:"app icon",className:"rounded-md border-2"})}),(0,s.jsx)("div",{className:"flex items-end h-12",children:(0,s.jsx)("div",{className:"w-px h-7 bg-gray-300"})}),(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2 max-w-[300px]",children:T.map(e=>(0,s.jsx)("div",{className:"cursor-pointer rounded-md border-2 transition-all duration-200 hover:border-[#0c75fc] ".concat(c===e.value?"border-[#0c75fc] bg-[#f5faff]":"border-gray-100 hover:bg-gray-50"),onClick:()=>{d(e.value),b.setFieldValue("app_icon",e.value)},children:(0,s.jsx)(E.default,{src:e.value,width:28,height:28,alt:e.label,className:"rounded-md"})},e.value))})})]})})]})})})})})};function P(){var e,a,l;let{modal:w,notification:C}=m.A.useApp(),S=(0,y.useRouter)(),{t:V}=(0,k.Bd)(),[E,T]=(0,A.useState)(!1),[P,O]=(0,A.useState)(!1),[I,R]=(0,A.useState)("all"),[B,q]=(0,A.useState)([]),[F,U]=(0,A.useState)("add"),{model:H,setAgent:J,setCurrentDialogInfo:L}=(0,A.useContext)(t.UK),D=(0,y.useSearchParams)(),M=null!=(l=null==D?void 0:D.get("openModal"))?l:"",[W,K]=(0,A.useState)(""),[X]=(0,A.useState)(),[Y,$]=(0,A.useState)(!1),[G,Q]=(0,A.useState)([]),Z=(0,A.useRef)(null),ee=(0,A.useCallback)(()=>{let e;"published"===I&&(e="true"),"unpublished"===I&&(e="false"),el({name_filter:W,published:e})},[I,W]),{run:ea}=(0,p.A)(async e=>"true"===e.published?await (0,n.Vb)((0,n.bl)(e.app_code)):await (0,n.Vb)((0,n.LU)({app_code:e.app_code})),{manual:!0,onSuccess:e=>{var a;(null==(a=e[2])?void 0:a.success)&&x.Ay.success("操作成功"),ee()}}),el=(0,u.A)(async e=>{O(!0);let a={page:1,page_size:12,...e},[l,s]=await (0,n.Vb)((0,n.eH)(a),C);if(l)return void O(!1);s&&(q((null==s?void 0:s.app_list)||[]),Z.current={current_page:(null==s?void 0:s.current_page)||1,total_count:(null==s?void 0:s.total_count)||0,total_page:(null==s?void 0:s.total_page)||0,page_size:12},O(!1))},{wait:500}).run;(0,A.useEffect)(()=>{M&&(U("add"),T(!0))},[M]);let es={en:V("English"),zh:V("Chinese")},et=async e=>{let[,a]=await (0,n.Vb)((0,n.j_)({app_code:e.app_code}));a&&(null==J||J(e.app_code),S.push("/chat/?app_code=".concat(e.app_code,"&conv_uid=").concat(a.conv_uid)))},en=[{value:"all",label:V("apps")},{value:"published",label:V("published")},{value:"unpublished",label:V("unpublished")}],ei=async e=>{K(e.target.value)},{run:er,loading:ec}=(0,p.A)(async e=>{let[,a]=await (0,n.Vb)((0,n.Eg)(e));return null!=a?a:[]},{manual:!0,onSuccess:e=>{Q(e)}}),{run:ed,loading:eo}=(0,p.A)(async e=>await (0,n.Vb)((0,n.Nr)(e)),{manual:!0,onSuccess:()=>{x.Ay.success("更新成功")}});return(0,A.useEffect)(()=>{X&&er(X.app_code)},[X,er]),(0,A.useEffect)(()=>{ee()},[ee]),(0,s.jsx)(h.A,{spinning:P,children:(0,s.jsxs)("div",{className:"h-screen w-full p-4 md:p-6 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4 sticky",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(g.A,{className:"backdrop-filter backdrop-blur-lg bg-white/30 border border-white rounded-lg shadow p-1 dark:border-[#6f7f95] dark:bg-[#6f7f95]/60 [&_.ant-segmented-item-selected]:bg-[#0c75fc]/80 [&_.ant-segmented-item-selected]:text-white",options:en,onChange:e=>{R(e)},value:I}),(0,s.jsx)(f.A,{variant:"filled",value:W,prefix:(0,s.jsx)(c.A,{}),placeholder:V("please_enter_the_keywords"),onChange:ei,onPressEnter:ei,allowClear:!0,className:"w-[230px] h-[40px] border-1 border-white backdrop-filter backdrop-blur-lg bg-white/30  dark:border-[#6f7f95] dark:bg-[#6f7f95]/60"})]}),(0,s.jsx)(b.Ay,{className:"border-none text-white bg-button-gradient flex items-center",icon:(0,s.jsx)(d.A,{className:"text-base"}),onClick:()=>{U("add"),T(!0),localStorage.removeItem("new_app_info")},children:V("create_app")})]}),(0,s.jsxs)("div",{className:"flex-1 flex-col w-full pb-12 mx-[-8px] overflow-y-auto",children:[(0,s.jsx)("div",{className:"flex flex-wrap flex-1 overflow-y-auto",children:B.map(e=>{var a;return(0,s.jsx)(i.Ay,{code:e.app_code,name:e.app_name,description:e.app_describe,logo:e.icon||"/icons/colorful-plugin.png",RightTop:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{content:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.A,{style:{color:"rgb(252,204,96)",fontSize:12}}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:V("copy_url")})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.A,{style:{color:"rgb(252,204,96)",fontSize:12}}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:V("double_click_open")})]})]})}),(0,s.jsx)(i._f,{menu:{items:[{key:"publish",label:(0,s.jsx)("span",{onClick:a=>{a.stopPropagation(),ea(e)},children:"true"===e.published?V("unpublish"):V("publish")})},{key:"del",label:(0,s.jsx)("span",{className:"text-red-400",onClick:a=>{a.stopPropagation(),w.confirm({title:V("Tips"),icon:(0,s.jsx)(r.A,{}),content:"do you want delete the application?",okText:"Yes",okType:"danger",cancelText:"No",async onOk(){await (0,n.Vb)((0,n.TT)({app_code:e.app_code})),ee()}})},children:V("Delete")})}]}})]}),Tags:(0,s.jsxs)("div",{children:[(0,s.jsx)(_.A,{children:es[e.language]}),(0,s.jsx)(_.A,{children:e.team_mode}),(0,s.jsx)(_.A,{children:e.published?V("published"):V("unpublished")})]}),rightTopHover:!1,LeftBottom:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("span",{children:e.owner_name}),(0,s.jsx)("span",{children:"•"}),(null==e?void 0:e.updated_at)&&(0,s.jsx)("span",{children:N()(null==e?void 0:e.updated_at).fromNow()+" "+V("update")})]}),RightBottom:(0,s.jsx)(i.VV,{onClick:()=>{et(e)}}),onClick:()=>{localStorage.setItem("new_app_info",JSON.stringify({...e,isEdit:!0})),S.replace("/application/structure/?app_code=".concat(e.app_code))},scene:(null==e||null==(a=e.team_context)?void 0:a.chat_scene)||"chat_agent"},e.app_code)})}),(0,s.jsx)("div",{className:"w-full flex justify-end shrink-0 pb-12 pt-1",children:(0,s.jsx)(j.A,{showSizeChanger:!1,total:(null==(e=Z.current)?void 0:e.total_count)||0,pageSize:12,current:null==(a=Z.current)?void 0:a.current_page,onChange:async(e,a)=>{await el({page:e})}})})]}),E&&(0,s.jsx)(z,{open:E,onCancel:()=>{T(!1)},refresh:el,type:F})]})})}},64420:(e,a,l)=>{Promise.resolve().then(l.bind(l,53132))},84182:(e,a,l)=>{"use strict";l.d(a,{Ay:()=>h,VV:()=>m,_f:()=>x});var s=l(95155),t=l(81106),n=l(97540),i=l(94600),r=l(90797),c=l(82343),d=l(29300),o=l.n(d),p=l(17985),u=l(66766);l(12115),l(2785);let m=e=>{let{onClick:a,Icon:l="/pictures/card_chat.png",text:t=(0,p.t)("start_chat")}=e;return"string"==typeof l&&(l=(0,s.jsx)(u.default,{src:l,alt:l,width:17,height:15})),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-default",onClick:e=>{e.stopPropagation(),a&&a()},children:[l,(0,s.jsx)("span",{children:t})]})},x=e=>{let{menu:a}=e;return(0,s.jsx)(c.A,{menu:a,getPopupContainer:e=>e.parentNode,placement:"bottomRight",autoAdjustOverflow:!1,children:(0,s.jsx)(t.A,{className:"p-2 hover:bg-white hover:dark:bg-black rounded-md"})})},h=e=>{let{RightTop:a,Tags:l,LeftBottom:t,RightBottom:c,onClick:d,rightTopHover:p=!0,logo:u,name:m,description:x,className:h,scene:g,code:f}=e;return"string"==typeof x&&(x=(0,s.jsx)("p",{className:"line-clamp-2 relative bottom-4 text-ellipsis min-h-[42px] text-sm text-[#525964] dark:text-[rgba(255,255,255,0.65)]",children:x})),(0,s.jsx)("div",{className:o()("hover-underline-gradient flex justify-center mt-6 relative group w-1/3 px-2 mb-6",h),children:(0,s.jsxs)("div",{onClick:d,className:"backdrop-filter backdrop-blur-lg cursor-pointer  bg-white/70  border-2 border-white rounded-lg shadow p-4 relative w-full h-full dark:border-[#6f7f95] dark:bg-[#6f7f95]/60",children:[(0,s.jsxs)("div",{className:"flex items-end relative bottom-8 justify-between w-full",children:[(0,s.jsxs)("div",{className:"flex items-end gap-4 w-11/12  flex-1",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm w-14 h-14 flex items-center p-2",children:(0,s.jsx)("img",{src:u,alt:m,className:"w-9 min-w-9 rounded-full max-w-none"})}),(0,s.jsx)("div",{className:"flex-1",children:m.length>6?(0,s.jsx)(n.A,{title:m,placement:"topLeft",children:(0,s.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:m})}):(0,s.jsx)("span",{className:"line-clamp-1 text-ellipsis font-semibold text-base",style:{maxWidth:"60%"},children:m})})]}),(0,s.jsx)("span",{className:o()("shrink-0",{hidden:p,"group-hover:block":p}),onClick:e=>{e.stopPropagation()},children:a})]}),x,(0,s.jsx)("div",{className:"relative bottom-2",children:l}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{children:t}),(0,s.jsx)("div",{children:c})]}),f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"my-3"}),(0,s.jsx)(r.A.Text,{copyable:!0,className:"absolute bottom-1 right-4 text-xs text-gray-500",children:f})]})]})})}}},e=>{e.O(0,[1448,342,586,8052,3769,5726,2013,7316,6939,1242,5566,6467,2570,964,7985,797,2343,7744,5887,8923,8219,1070,8441,5964,7358],()=>e(e.s=64420)),_N_E=e.O()}]);